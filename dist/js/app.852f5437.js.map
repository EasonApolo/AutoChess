{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?3c29","webpack:///./src/assets/card.js","webpack:///./src/assets/helper.js","webpack:///./src/assets/position.js","webpack:///./src/assets/util.js","webpack:///./src/assets/chess.js","webpack:///./src/assets/class.js","webpack:///./src/assets/color.js","webpack:///./src/assets/equip.js","webpack:///./src/assets/script.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?165b"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","entry","staticClass","login","_e","directives","rawName","expression","domProps","on","$event","target","composing","$set","_v","_s","error","signup","inroom","createRoom","_l","room","id","class","disable","users","joinRoom","start","stage","u","startRoom","exitRoom","inentry","staticStyle","w","h","click","mousemove","src","undefined","showChess","style","left","showPos","top","ad","toFixed","as","range","armor","mr","buff","index","staticRenderFns","randInt","Math","floor","random","removeFromArr","arr","obj","indexOf","numberize","map","v","Number","sqrt","util_tgt","vm","tgt","coord","getCoord","pos","status","prepare","util","x","y","tx","ty","ready","getEuclid","dsp","sp","damage","util_attack","type","ctx","xbase","ybase","fillStyle","fillRect","util_lucian_second_bullet","size","sz","strokeStyle","strokeRect","util_tristana_bomb","bomb_sp","bomb_sz","buff_tristana_explosiveSpark","util_area","util_yasuo_tempest","end","base","lvl","width","pre","post","done","g1","g2","grids","board","grid","getDistance","camp","opacity","lineWidth","beginPath","srcPos","tgtPos","moveTo","lineTo","stroke","util_yasuo_tornado","x_len","y_len","now","len","PosInfo","w1","been","stun","stun_type","rate","arc","PI","util_graves_buckshot","xys","buff_regainMana","includes","val","regain","_mp","mp","buff_lucian_nextAttackWith","setTimeout","explode","sixpos","getSixPos","adj","cenL","cenT","buff_val","buff_graves_buckshot","ratio","x1","y1","x0","y0","midAngle","atan","angles","cos","sin","buff_class_gun","extra","trigger","avails","console","log","createUtilAttack","chess","dead","e","equips","equipTo","bonus","res","response","_ad","_name","_as","_range","cat","hp","spell_pre","spell","attack","spell_sp","jump","pn","spell_stage","tgtLen","info","xt","yt","set_buff_class_gun","exact","section","cardText","reDealButton","upgradeButton","gold","chessHpBorder","chessHp","chessHpOppo","chessMp","chessSp","equip","buff0","buff1","concat","upgradeExp","password","rooms","fetchID","canvas","mouse","game","turn","exp","costUpgrade","costRedeal","damageRecord","grave","classes","schedule","enemy","clickBoard","combo","hold","store","cards","Array","fill","hand","allsrc","queue","ip","created","addEventListener","initBoard","mounted","setInterval","fetchStatus","computed","sortedRoomUsers","sort","methods","getUserIndex","findIndex","getEnemyIndex","getMeIndex","dealError","fetch","formData","append","k","param","Promise","body","method","json","reject","then","fetchRoom","fetchRooms","clearInterval","fetchGameStatus","startGame","document","documentElement","clientWidth","clientHeight","getElementById","getContext","deal","main","actAll","clearAll","drawBoard","drawHand","drawStore","drawHold","drawUtil","drawDamageRecord","drawclasses","drawEquips","drawSchedule","drawPlayers","requestAnimationFrame","updateGold","updateExp","tmp","equiping","setChess","buyDeal","buyUpgrade","buyCard","buy","addExp","require","wannaBuy","cost","storeId","addChess","startRound","checkRemain","initAllChess","nearestPos","nearestDis","moveChess","dealBuff","castSpell","path","orient","getOrient","move","mitigate","pair","intDamage","record","_hp","die","camp0","camp1","g","updateClasses","oppoClasses","initClassBuffs","chessNames","active","setChessByData","createChess","getPosByCoord","r1","c1","r2","getOrientGrid","odd","samePos","a","b","getPathNode","displayflag","close","flag","minD","paths","unshift","ret_path","getShortestPath","minLen","minInd","getPath","open","cen","sixPos","pow","colD","dis","rowD","findNearestOppo","minDis","minSet","nearest","setGrid","cardId","clearRect","draw","closePath","biasX","biasD","biasY","img","drawImage","handL","handT","hw","hh","cardL","cardT","cw","strL","strT","bw","bh","font","textAlign","fillText","textBaseline","sch","user","component","Vue","config","productionTip","render","App","$mount"],"mappings":"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","file":"js/app.852f5437.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(_vm.entry.inentry)?_c('div',{staticClass:\"entry\"},[(!_vm.entry.login)?_c('div',{staticClass:\"block\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.entry.name),expression:\"entry.name\"}],attrs:{\"placeholder\":\"name\"},domProps:{\"value\":(_vm.entry.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.entry, \"name\", $event.target.value)}}}),_c('br'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.entry.password),expression:\"entry.password\"}],attrs:{\"placeholder\":\"password\"},domProps:{\"value\":(_vm.entry.password)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.entry, \"password\", $event.target.value)}}}),_c('br'),(_vm.entry.error)?_c('div',[_vm._v(_vm._s(_vm.entry.error))]):_vm._e(),_c('button',{on:{\"click\":_vm.login}},[_vm._v(\"登录\")]),_c('button',{on:{\"click\":_vm.signup}},[_vm._v(\"注册\")])]):_vm._e(),(_vm.entry.login && !_vm.entry.inroom)?_c('div',{staticClass:\"block\"},[_vm._v(\"\\n      \"+_vm._s(_vm.entry.name)+\"\\n      \"),_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.entry.name),expression:\"entry.name\"}],on:{\"click\":_vm.createRoom}},[_vm._v(\"创建房间\")]),(_vm.entry.error)?_c('div',[_vm._v(_vm._s(_vm.entry.error))]):_vm._e(),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.entry.name),expression:\"entry.name\"}],staticClass:\"block-list\"},[_vm._v(\"\\n      房间列表：\\n        \"),_vm._l((_vm.entry.rooms),function(room){return _c('div',{key:room.id,class:{disable:room.users.length>=2},on:{\"click\":function($event){return _vm.joinRoom(room.id)}}},[_c('span',[_vm._v(_vm._s(room.users[0].name))]),(room.users[1])?_c('span',[_vm._v(_vm._s(room.users[1].name))]):_vm._e(),(!room.start)?_c('span',{staticClass:\"span-right\"},[_vm._v(_vm._s(room.users.length)+\"/2 准备中\")]):_vm._e(),(room.start)?_c('span',{staticClass:\"span-right\"},[_vm._v(\"第\"+_vm._s(room.stage)+\"回合\")]):_vm._e()])})],2)]):_vm._e(),(_vm.entry.inroom)?_c('div',{staticClass:\"block\"},[_vm._v(\"\\n      \"+_vm._s(_vm.entry.name)+\"\\n      \"),_c('div',[_vm._v(\"房间中\")]),(_vm.entry.error)?_c('div',[_vm._v(_vm._s(_vm.entry.error))]):_vm._e(),_c('div',{staticClass:\"block-list\"},[_vm._v(\"\\n        玩家列表：\\n        \"),_vm._l((_vm.entry.room.users),function(u){return _c('div',{key:u.id},[_vm._v(_vm._s(u.name))])})],2),_c('button',{attrs:{\"disabled\":_vm.entry.room.users.length<2},on:{\"click\":_vm.startRoom}},[_vm._v(\"开始\")]),_c('button',{on:{\"click\":_vm.exitRoom}},[_vm._v(\"退出\")])]):_vm._e()]):_vm._e(),(!_vm.entry.inentry)?_c('div',{staticClass:\"game\"},[_c('canvas',{staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"id\":\"canvas\",\"width\":_vm.w,\"height\":_vm.h},on:{\"click\":_vm.click,\"mousemove\":_vm.mousemove}}),_vm._l((_vm.allsrc),function(src){return _c('div',{key:src,staticStyle:{\"display\":\"none\"}},[_c('img',{attrs:{\"src\":src}})])}),(_vm.showChess!==undefined)?_c('div',{staticClass:\"show\",style:({left:_vm.showPos[0],top:_vm.showPos[1]})},[_vm._v(\"\\n      \"+_vm._s(_vm.showChess.name)+\"\\n      \"),_c('div',{staticClass:\"attr\"},[_c('div',[_vm._v(\"ad:\")]),_c('div',[_vm._v(_vm._s(_vm.showChess.ad.toFixed(0)))]),_c('div',[_vm._v(\"as:\")]),_c('div',[_vm._v(_vm._s(_vm.showChess.as.toFixed(2)))]),_c('div',[_vm._v(\"range:\")]),_c('div',[_vm._v(_vm._s(_vm.showChess.range.toFixed(0)))]),_c('div',[_vm._v(\"armor:\")]),_c('div',[_vm._v(_vm._s(_vm.showChess.armor.toFixed(0)))]),_c('div',[_vm._v(\"mr:\")]),_c('div',[_vm._v(_vm._s(_vm.showChess.mr.toFixed(0)))])]),_c('div',{staticClass:\"buff\"},_vm._l((_vm.showChess.buff),function(buff,index){return _c('div',{key:index},[_vm._v(\"\\n          \"+_vm._s(buff.name)+\"\\n        \")])}),0)]):_vm._e()],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default [\r\n    {\r\n        \"id\": 0,\r\n        \"name\": \"麦林炮手\",\r\n        \"cost\": 1,\r\n        \"cat\": [0, 1]\r\n    },\r\n    {\r\n        \"id\": 1,\r\n        \"name\": \"圣枪游侠\",\r\n        \"cost\": 2,\r\n        \"cat\": [0, 2]\r\n    },\r\n    {\r\n        \"id\": 2,\r\n        \"name\": \"疾风剑豪\",\r\n        \"cost\": 5,\r\n        \"cat\": [3, 4]\r\n    },\r\n    {\r\n        \"id\": 3,\r\n        \"name\": \"法外狂徒\",\r\n        \"cost\": 1,\r\n        \"cat\": [0, 5]\r\n    }\r\n]\r\n\r\n","export function randInt (r, s=0) {\r\n  return Math.floor(Math.random()*r)+s\r\n}\r\nexport function removeFromArr (arr, obj) {\r\n  arr.splice(arr.indexOf(obj), 1)\r\n}\r\nexport function numberize (arr) {\r\n  return arr.map(v=>Number(v))\r\n}\r\nexport function findExistKey (arr, key, val) {\r\n  for (let i in arr) {\r\n    if (arr[i][key] === val) {\r\n      return i\r\n    }\r\n  }\r\n  return undefined\r\n}","export default {\r\n    \"board\": {\r\n        \"marTop\": 200,\r\n        \"w\": 1500,\r\n        \"h\": 1100,\r\n        \"w1\": 110,  // radius of grid\r\n        \"ratio\": Math.sqrt(3) / 2,\r\n        \"w2\": 132,  // width of chess image\r\n        \"wEquip\": 44,  // width of chess image\r\n        'hpW': 120,\r\n        'hpT': 70,\r\n        'hpH': 3,\r\n        'mpT': 67,\r\n        'spT': 64,\r\n    },\r\n    \"hand\": {\r\n        \"marTop\": 1300+10,\r\n        \"w\": 240*9+10*10,\r\n        \"h\": 240+2*10,\r\n        \"w1\": 240,\r\n        \"wEquip\": 44,\r\n        \"sp\": 10\r\n    },\r\n    \"store\": {\r\n        \"w\": 260*6+20*7,\r\n        \"h\": 300,\r\n        \"w1\": 260,\r\n        \"sp\": 20,\r\n        \"bh\": 220/3\r\n    },\r\n    \"record\": {\r\n        'l': 100,\r\n        't': 100,\r\n        'spw':50,\r\n        'sph':30\r\n    },\r\n    \"class\": {\r\n        'l': 100,\r\n        't': 500,\r\n        'spw': 70,\r\n        'sph': 30\r\n    },\r\n    \"equips\": {\r\n        'l': 100,\r\n        't': 600,\r\n        'h': 70\r\n    },\r\n    'schedule': {\r\n        't': 70,\r\n        'arcR': 50,\r\n    },\r\n    'player': {\r\n        'l': 800,\r\n        't': 600,\r\n        'spw': 100,\r\n        'sph': 40\r\n    }\r\n}\r\n","import { removeFromArr } from \"./helper\";\r\nimport { buff_tristana_explosiveSpark } from \"./chess\";\r\nimport PosInfo from './position'\r\n\r\nexport class util_tgt {\r\n  constructor (vm, src, tgt) {\r\n    this.src = src\r\n    this.tgt = tgt\r\n    this.vm = vm\r\n    this.coord = this.vm.getCoord(...src.pos)\r\n    this.status = {prepare:true}\r\n    this.vm.util.push(this)\r\n  }\r\n  act () {\r\n    let [x, y] = this.coord\r\n    let [tx, ty] = this.vm.getCoord(...this.tgt.pos)\r\n    if (x === tx && y === ty) {\r\n      this.status.ready=true\r\n      this.status.prepare = false\r\n    }\r\n    let d = this.vm.getEuclid(x, y, tx, ty)\r\n    let dsp = this.sp/60/d\r\n    if (dsp>1) {  // arrive tgt\r\n      this.coord[0] = tx\r\n      this.coord[1] = ty\r\n    } else {\r\n      this.coord[0] = x + dsp*(tx-x)\r\n      this.coord[1] = y + dsp*(ty-y)\r\n    }\r\n  }\r\n  effect () {\r\n    this.vm.damage(this)\r\n    removeFromArr(this.vm.util, this)\r\n  }\r\n}\r\nexport class util_attack extends util_tgt {\r\n  constructor (vm, src, tgt) {\r\n    super(vm, src, tgt)\r\n    this.damage = src.ad\r\n    this.sp = src.util.sp\r\n    this.type = 0\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    ctx.fillStyle = 'blue'\r\n    ctx.fillRect(xbase+this.coord[0]-5, ybase+this.coord[1]-5, 10, 10)\r\n  }\r\n}\r\nexport class util_lucian_second_bullet extends util_tgt {\r\n  constructor (vm, src, tgt, damage) {\r\n    super(vm, src, tgt)\r\n    this.sp = src.util.sp\r\n    this.size = src.util.sz\r\n    this.damage = damage\r\n    this.type = 1\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    ctx.fillStyle = 'white'\r\n    ctx.fillRect(xbase+this.coord[0]-this.size/2, ybase+this.coord[1]-this.size/2, this.size, this.size)\r\n    ctx.strokeStyle = 'black'\r\n    ctx.strokeRect(xbase+this.coord[0]-this.size/2, ybase+this.coord[1]-this.size/2, this.size, this.size)\r\n  }\r\n}\r\nexport class util_tristana_bomb extends util_tgt {\r\n  constructor (vm, src, tgt) {\r\n    super(vm, src, tgt)\r\n    this.sp = src.util.bomb_sp\r\n    this.size = src.util.bomb_sz\r\n    this.type = 1\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    ctx.fillStyle = 'red'\r\n    ctx.fillRect(xbase+this.coord[0]-this.size/2, ybase+this.coord[1]-this.size/2, this.size, this.size)\r\n    ctx.strokeStyle = 'black'\r\n    ctx.strokeRect(xbase+this.coord[0]-this.size/2, ybase+this.coord[1]-this.size/2, this.size, this.size)\r\n  }\r\n  effect () {\r\n    this.tgt.buff.push(new buff_tristana_explosiveSpark(this.vm, this.src, this.tgt))\r\n    removeFromArr(this.vm.util, this)\r\n  }\r\n}\r\nexport class util_area {\r\n  constructor (vm, src) {\r\n    this.vm = vm,\r\n    this.vm.util.push(this)\r\n    this.src = src,\r\n    this.status = {prepare:true}\r\n  }\r\n}\r\nexport class util_yasuo_tempest extends util_area {\r\n  constructor (vm, src, start, end) {\r\n    super(vm, src)\r\n    this.base = [150, 350, 550]\r\n    this.damage = this.base[this.src.lvl]\r\n    this.start = start\r\n    this.end = end\r\n    this.width = 10\r\n    this.type = 1\r\n    this.pre = 5\r\n    this.post = 20\r\n  }\r\n  act () {\r\n    if (this.status.prepare) {\r\n      if (this.pre <= 0) {\r\n        this.status = {ready:true}\r\n      } else {\r\n        this.pre --\r\n      }\r\n    } else if (this.status.done) {\r\n      if (this.post <= 0) {\r\n        removeFromArr(this.vm.util, this)\r\n      } else {\r\n        this.post --\r\n      }\r\n    }\r\n  }\r\n  effect () {\r\n    this.status = {done:true}\r\n    let g1 = [(this.start[0]+this.end[0])/2, (this.start[1]+this.end[1])/2]\r\n    let g2 = this.end\r\n    let grids = this.vm.board.grid\r\n    for (let r in grids) {\r\n      for (let c in grids) {\r\n        if (grids[r][c] !== undefined && this.vm.getDistance(...this.src.pos, r, c) < 3 && this.src.camp !== grids[r][c].camp) { // only compute possible grid\r\n          if (this.vm.getEuclid(...g1, ...(this.vm.getCoord(r, c))) < (66 + 10) || this.vm.getEuclid(...g2, ...(this.vm.getCoord(r, c))) < (66+10)) {\r\n            this.vm.damage(this, grids[r][c])\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    let opacity = this.pre > 0 ? 1-this.pre/5 : this.post / 20\r\n    ctx.lineWidth = 5\r\n    ctx.strokeStyle = `rgba(222, 222, 222, ${opacity})`\r\n    ctx.beginPath()\r\n    let srcPos = [this.start[0]+xbase,this.start[1]+ybase]\r\n    let tgtPos = [this.end[0]+xbase,this.end[1]+ybase]\r\n    ctx.moveTo(...srcPos)\r\n    ctx.lineTo(...tgtPos)\r\n    ctx.stroke()\r\n    ctx.lineWidth = 1\r\n  }\r\n}\r\nexport class util_yasuo_tornado extends util_area{\r\n  constructor (vm, src, x_len, y_len) {\r\n    super(vm, src)\r\n    this.w = 0    // radius\r\n    this.sp = 90  // finish in 60 ticks\r\n    this.now = 0  // current tick\r\n    this.len = PosInfo.board.w1 * 10  // total length\r\n    this.start = this.vm.getCoord(...src.pos)              // start pos\r\n    this.pos = this.start\r\n    this.x_len = x_len\r\n    this.y_len = y_len\r\n    this.been = []\r\n    this.post = 20\r\n    this.base = [150, 350, 550]\r\n    this.damage = this.base[this.src.lvl]\r\n    this.stun = 1.5 * 60\r\n    this.stun_type = 0\r\n  }\r\n  act () {\r\n    if (this.status.prepare) {\r\n      if (this.now === this.sp) {\r\n        this.status = {done:true}\r\n        this.post = this.sp/3\r\n        return\r\n      }\r\n      let rate = this.now / this.sp\r\n      this.w = this.now\r\n      this.pos = [rate*this.x_len + this.start[0], rate*this.y_len + this.start[1]]\r\n      let grids = this.vm.board.grid\r\n      for (let r in grids) {\r\n        for (let c in grids[r]) {\r\n          if (grids[r][c] !== undefined && grids[r][c].camp !== this.src.camp && this.been.indexOf(grids[r][c]) < 0) {\r\n            // console.log(grids[r][c], this.been, this.been.indexOf(grids[r][c]))\r\n            if (this.vm.getEuclid(...this.pos, ...this.vm.getCoord(r,c)) < (66 + this.w)) {\r\n              this.vm.damage(this, grids[r][c])\r\n              if (grids[r][c]) {\r\n                this.vm.stun(this, grids[r][c])\r\n              }\r\n              this.been.push(grids[r][c])\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.now++\r\n    } else if (this.status.done) {\r\n      this.w = this.post*3\r\n      if (this.post <= 0) {\r\n        removeFromArr(this.vm.util, this)\r\n      }\r\n      this.post --\r\n    }\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    ctx.strokeStyle = 'rgb(200,200,200)'\r\n    ctx.lineWidth = '5'\r\n    ctx.beginPath()\r\n    ctx.arc(this.pos[0]+xbase, this.pos[1]+ybase, this.w, 0, 2*Math.PI)\r\n    ctx.stroke()\r\n    ctx.lineWidth = '1'\r\n  }\r\n}\r\n\r\n\r\nexport class util_graves_buckshot extends util_area{\r\n  constructor (vm, src, xys) {\r\n    super(vm, src)\r\n    this.w = 10   // radius\r\n    this.sp = 10  // finish in 60 ticks\r\n    this.now = 0  // current tick\r\n    this.start = this.vm.getCoord(...src.pos)              // start pos\r\n    this.xys = xys\r\n    this.pos = xys.map(v => this.start)\r\n    this.been = [this.src.status.target]\r\n    this.post = 20\r\n    this.damage = this.src.ad\r\n  }\r\n  act () {\r\n    if (this.status.prepare) {\r\n      if (this.now === this.sp) {\r\n        this.status = {done:true}\r\n        return\r\n      }\r\n      let rate = this.now / this.sp\r\n      for (let i in this.xys) {\r\n        this.pos[i] = [this.start[0]+this.xys[i][0]*rate, this.start[1]+this.xys[i][1]*rate]\r\n      }\r\n      let grids = this.vm.board.grid\r\n      for (let r in grids) {\r\n        for (let c in grids[r]) {\r\n          if (grids[r][c] !== undefined && grids[r][c].camp !== this.src.camp && this.been.indexOf(grids[r][c]) < 0) {\r\n            for (let i in this.pos) {\r\n              if (this.vm.getEuclid(...this.pos[i], ...this.vm.getCoord(r,c)) < (66 + this.w)) {\r\n                this.vm.damage(this, grids[r][c])\r\n                this.been.push(grids[r][c])\r\n                break\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.now++\r\n    } else if (this.status.done) {\r\n      if (this.post <= 0) {\r\n        removeFromArr(this.vm.util, this)\r\n      }\r\n      this.post --\r\n    }\r\n  }\r\n  draw (ctx, xbase, ybase) {\r\n    ctx.strokeStyle = this.status.prepare ? '#eec545' : `rgba(238,197,69,${this.post/20})`\r\n    ctx.lineWidth = '3'\r\n    for (let i in this.pos) {\r\n      ctx.beginPath()\r\n      ctx.moveTo(this.start[0]+xbase, this.start[1]+ybase)\r\n      ctx.lineTo(this.pos[i][0]+xbase, this.pos[i][1]+ybase)\r\n      ctx.stroke()\r\n    }\r\n    ctx.lineWidth = '1'\r\n  }\r\n}\r\n\r\n// export class util_aatrox_blade extends util_area{\r\n//   constructor (vm, src, x_len, y_len) {\r\n//     super(vm, src)\r\n//     this.w = 0    // radius\r\n//     this.sp = 90  // finish in 60 ticks\r\n//     this.now = 0  // current tick\r\n//     this.start = this.vm.getCoord(...src.pos)              // start pos\r\n//     this.pos = this.start\r\n//     this.post = 20\r\n//     this.base = [150, 350, 550]\r\n//     this.damage = this.base[this.src.lvl]\r\n//   }\r\n//   act () {\r\n//     if (this.status.prepare) {\r\n//       if (this.now === this.sp) {\r\n//         this.status = {done:true}\r\n//         this.post = this.sp/3\r\n//         return\r\n//       }\r\n//       let rate = this.now / this.sp\r\n//       this.w = this.now\r\n//       this.pos = [rate*this.x_len + this.start[0], rate*this.y_len + this.start[1]]\r\n//       let grids = this.vm.board.grid\r\n//       for (let r in grids) {\r\n//         for (let c in grids[r]) {\r\n//           if (grids[r][c] !== undefined && grids[r][c].camp !== this.src.camp && this.been.indexOf(grids[r][c]) < 0) {\r\n//             // console.log(grids[r][c], this.been, this.been.indexOf(grids[r][c]))\r\n//             if (this.vm.getEuclid(...this.pos, ...this.vm.getCoord(r,c)) < (66 + this.w)) {\r\n//               this.vm.damage(this, grids[r][c])\r\n//               if (grids[r][c]) {\r\n//                 this.vm.stun(this, grids[r][c])\r\n//               }\r\n//               this.been.push(grids[r][c])\r\n//             }\r\n//           }\r\n//         }\r\n//       }\r\n//       this.now++\r\n//     } else if (this.status.done) {\r\n//       this.w = this.post*3\r\n//       if (this.post <= 0) {\r\n//         removeFromArr(this.vm.util, this)\r\n//       }\r\n//       this.post --\r\n//     }\r\n//   }\r\n//   draw (ctx, xbase, ybase) {\r\n//     ctx.strokeStyle = 'rgb(200,200,200)'\r\n//     ctx.lineWidth = '5'\r\n//     ctx.beginPath()\r\n//     ctx.arc(this.pos[0]+xbase, this.pos[1]+ybase, this.w, 0, 2*Math.PI)\r\n//     ctx.stroke()\r\n//     ctx.lineWidth = '1'\r\n//   }\r\n// }","import { util_lucian_second_bullet, util_tristana_bomb, util_yasuo_tempest, util_yasuo_tornado, util_graves_buckshot } from \"./util\";\r\nimport { randInt, removeFromArr } from './helper'\r\nimport { setTimeout } from \"core-js\";\r\nimport PosInfo from './position'\r\n\r\nexport class buff {\r\n  constructor (vm, src) {\r\n    this.vm = vm\r\n    this.src = src\r\n  }\r\n}\r\n\r\nexport class buff_regainMana extends buff {\r\n  constructor (vm, src) {\r\n    super(vm, src)\r\n  }\r\n  response (type, ...args) {\r\n    if (['damage', 'attack'].includes(type)) {\r\n      if (type === 'damage') {\r\n        let val = args[0]\r\n        let util = args[1]\r\n        let regain = val * 0.1\r\n        this.src._mp += regain\r\n      } else if (type === 'attack') {\r\n        this.src._mp += randInt(5, 6)\r\n      }\r\n      // prevent overflow\r\n      if (this.src._mp >= this.src.mp) this.src._mp = this.src.mp\r\n    }\r\n  }\r\n}\r\n\r\nexport class buff_lucian_nextAttackWith extends buff {\r\n  constructor (vm, src, tgt) {\r\n    super(vm, src)\r\n    this.name = '圣枪银弹'\r\n    this.tgt = tgt\r\n    this.base = [100, 225, 350]\r\n  }\r\n  response (type, ...args) {\r\n    if (type === 'attack') {\r\n      setTimeout(() => {\r\n        if (this.tgt) {\r\n          new util_lucian_second_bullet(this.vm, this.src, this.tgt, this.base[this.src.lvl])\r\n        }\r\n      }, 300)\r\n      removeFromArr(this.src.buff, this)\r\n    }\r\n  }\r\n}\r\n\r\nexport class buff_tristana_explosiveSpark extends buff {\r\n  constructor (vm, src, tgt) {\r\n    super(vm, src)\r\n    this.name = '爆炸火花'\r\n    this.stage = 0\r\n    this.tgt = tgt\r\n    this.base = [150, 225, 300]\r\n    this.lvl = src.lvl\r\n    this.damage = 0\r\n    this.type = 1\r\n    setTimeout(() => {\r\n      if (this.damage === 0) {    // warning\r\n        this.explode()\r\n      }\r\n    }, 4000)\r\n  }\r\n  response (type, ...args) {\r\n    if (type === 'damage') {\r\n      let util = args[1]\r\n      if (util.tgt === this.tgt && util.src === this.src) {\r\n        this.stage ++\r\n        if (this.stage >= 3) {\r\n          this.explode()\r\n        }\r\n      }\r\n    }\r\n  }\r\n  explode () {\r\n    removeFromArr(this.tgt.buff, this)\r\n    this.damage = (1 + this.stage * 0.5) * this.base[this.lvl]\r\n    let sixpos = this.vm.getSixPos(this.tgt.pos)\r\n    for (let i in sixpos) {\r\n      let pos = sixpos[i]\r\n      let adj = this.vm.board.grid[pos[0]][pos[1]]\r\n      if (adj != undefined && adj.camp != this.src.camp) {\r\n        this.vm.damage(this, adj)\r\n      }\r\n    }\r\n    this.vm.damage(this)\r\n  }\r\n  draw (ctx, cenL, cenT) {\r\n    ctx.fillStyle = 'red'\r\n    let r = 6*(this.stage+1)\r\n    ctx.fillRect(cenL-r, cenT-r,2*r,2*r)\r\n  }\r\n}\r\n// type: ad / hp / armor / mr / as\r\nexport class buff_val extends buff {\r\n  constructor (vm, src, type, val, rate=0, name=undefined) {\r\n    super(vm, src)\r\n    this.type = type\r\n    this.val = val\r\n    this.rate = rate\r\n    if (name) {\r\n      this.name = name\r\n    }\r\n  }\r\n  response (type) {\r\n    if (type === this.type) {\r\n      return [this.val, this.rate]\r\n    }\r\n  }\r\n}\r\n\r\nexport class buff_graves_buckshot extends buff {\r\n  constructor (vm, src) {\r\n    super(vm, src)\r\n    this.name = '大号铅弹'\r\n  }\r\n  response (type, ...args) {\r\n    if (['attack'].includes(type)) {\r\n      let len = (this.src.range+1)*2 *PosInfo.board.w1*PosInfo.board.ratio // if range 1, attack 2block(4w), if range \r\n      let [x1, y1] = this.vm.getCoord(...this.src.status.target.pos)\r\n      let [x0, y0] = this.vm.getCoord(...this.src.pos)\r\n      let midAngle = Math.atan((y1-y0)/(x1-x0))\r\n      if (x1 < x0) {  // arctan only get -PI/2 ~ PI/2 (always right side)\r\n        midAngle = Math.PI+midAngle\r\n      }\r\n      let angles = []\r\n      for (let i=0; i < 6; i++) {\r\n        angles.push(midAngle+(i-2.5)*Math.PI*2/30)\r\n      }\r\n      angles = angles.map(v => {\r\n        return [len*Math.cos(v),len*Math.sin(v)]\r\n      })\r\n      new util_graves_buckshot(this.vm, this.src, angles)\r\n    }\r\n  }\r\n}\r\n\r\nexport class buff_class_gun extends buff {\r\n  constructor (vm, src, stage) {\r\n    super(vm, src)\r\n    this.base = [1, 2, 3]\r\n    this.extra = this.base[stage]\r\n    this.name = '枪手'\r\n  }\r\n  response(type, ...args) {\r\n    if (['attack'].includes(type)) {\r\n      let trigger = randInt(2)\r\n      if (trigger) {\r\n        let grids = this.vm.board.grid\r\n        let avails = []\r\n        for (let r in grids) {\r\n          for (let c in grids[r]) {\r\n            if (grids[r][c] && grids[r][c].camp !== this.src.camp\r\n            && this.vm.getDistance(r, c, ...this.src.pos) < this.src.range  // in range\r\n            && grids[r][c] !== this.src.status.tgt) {                       // not current tgt\r\n              avails.push([r,c])\r\n            }\r\n          }\r\n        }\r\n        if (this.src.id === 1) {\r\n          console.log(avails)\r\n        }\r\n        if (avails.length === 0) return\r\n        else if (avails.length > this.extra) {\r\n          do {\r\n            avails.splice(randInt(avails.length), 1)\r\n          } while (avails.length > this.extra)\r\n        }\r\n        if (this.src.id === 1) {\r\n          console.log(avails)\r\n        }\r\n        for (let i in avails) {\r\n          this.vm.createUtilAttack(this.src, grids[avails[i][0]][avails[i][1]])\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport class chess {\r\n  constructor (vm) {\r\n    this.vm = vm\r\n  }\r\n  die () {\r\n    // remove chess from board\r\n    let grid = this.vm.board.grid\r\n    grid[this.pos[0]][this.pos[1]] = undefined\r\n    // set chess status as dead, so other chess and util will remove it.\r\n    for (let i in this.status) {\r\n      this.status[i] = undefined\r\n    }\r\n    this.status.dead = true\r\n  }\r\n  equip (e) {\r\n    if (this.equips.length < 3) {\r\n      this.equips.push(e)\r\n      e.equipTo(this)\r\n    }\r\n  }\r\n  get ad () {\r\n    let rate = 1\r\n    let bonus = 0\r\n    for (let i in this.buff) {\r\n      let res = this.buff[i].response('ad')\r\n      if (res) {\r\n        if (res[1]) {\r\n          rate += res[0]\r\n        } else {\r\n          bonus += res[0]\r\n        }\r\n      }\r\n    }\r\n    return (this._ad + bonus) * rate\r\n  }\r\n  set ad (ad) {\r\n    this._ad = ad\r\n  }\r\n  get name () {\r\n    return this._name\r\n  }\r\n  set name (name) {\r\n    this._name = name\r\n  }\r\n  get as () {\r\n    let rate = 1\r\n    for (let i in this.buff) {\r\n      let res = this.buff[i].response('as')\r\n      if (res) {\r\n        if (res[1]) {\r\n          rate += res[0]\r\n        } else {\r\n          console.log('myError：as buff not rate')\r\n        }\r\n      }\r\n    }\r\n    return this._as * rate\r\n  }\r\n  set as (as) {\r\n    this._as = as\r\n  }\r\n  get range () {\r\n    let rate = 1\r\n    for (let i in this.buff) {\r\n      let res = this.buff[i].response('range')\r\n      if (res) {\r\n        if (res[1]) {\r\n          rate += res[0]\r\n        } else {\r\n          console.log('myError：as buff not rate')\r\n        }\r\n      }\r\n    }\r\n    return this._range * rate\r\n  }\r\n  set range (range) {\r\n    this._range = range\r\n  }\r\n}\r\n\r\n// chess class definitions:\r\n\r\nexport default [\r\n  class Tristana extends chess {\r\n    constructor (vm) {\r\n      super(vm)\r\n      this.id = 0,\r\n      this._name = '麦林炮手',\r\n      this.size = 0.8,\r\n      this.cat = [0, 1],\r\n      this.src = 'Tristana_d.png',\r\n      this.hp = 550,\r\n      this.mp = 50,\r\n      this._ad = 50,\r\n      this._as = 0.65,\r\n      this.sp = 75,\r\n      this._range = 4,\r\n      this.armor = 20,\r\n      this.mr = 20,\r\n      this.util = {\r\n        sp: 800,\r\n        bomb_sp: 600,\r\n        bomb_sz: 6\r\n      },\r\n      this.lvl = 0\r\n      this.buff = [\r\n      ],\r\n      this.spell_pre = 10\r\n      this.spell = function explosiveSpark () {\r\n        if (this.status.target) {\r\n          new util_tristana_bomb(this.vm, this, this.status.target)\r\n        }\r\n        this.status.spell = undefined\r\n        this.status.attack = 0\r\n      }\r\n    }\r\n  },\r\n\r\n  class Lucian extends chess {\r\n    constructor (vm) {\r\n      super(vm)\r\n      this.id = 1,\r\n      this._name = '圣枪游侠',\r\n      this.size = 0.8,\r\n      this.cat = [0, 2],\r\n      this.src = 'Lucian_d.png',\r\n      this.hp = 550,\r\n      this.mp = 35,\r\n      this._ad = 65,\r\n      this._as = 0.65,\r\n      this.range = 3,\r\n      this.sp = 60,\r\n      this.armor = 20,\r\n      this.mr = 20,\r\n      this.util = {\r\n        sp: 1000,\r\n        spell_sp: 20,\r\n        sz: 10,\r\n      },\r\n      this.lvl = 0\r\n      this.buff = [\r\n      ]\r\n      this.spell_pre = 0\r\n      this.spell = function relentless_pursuit () {\r\n        if (this.status.target) {\r\n          let grid = this.vm.board.grid\r\n          let avails = []\r\n          for (let r in grid) {\r\n            for (let c in grid[r]) {\r\n              if (grid[r][c] === undefined && this.vm.getDistance(r,c, ...this.pos) <= 2 && this.vm.getDistance(r,c,...this.status.target.pos) <= this.range) {\r\n                avails.push([r,c])\r\n              }\r\n            }\r\n          }\r\n          if (avails.length) {\r\n            this.status.attack = undefined\r\n            this.status.spell = undefined\r\n            this.status.jump = {p:0, pn:this.util.spell_sp, src: this.pos, tgt: avails[randInt(avails.length)]}\r\n            this.buff.push(new buff_lucian_nextAttackWith(this.vm, this, this.status.target))\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  class Yasuo extends chess {\r\n    constructor (vm) {\r\n      super(vm)\r\n      this.id = 2,\r\n      this._name = '疾风剑豪',\r\n      this.lvl = 0\r\n      this.size = 0.8,\r\n      this.cat = [3, 4],\r\n      this.src = 'Yasuo_d.png',\r\n      this.hp = 700,\r\n      this.mp = 25,\r\n      this._ad = 75,\r\n      this._as = 1,\r\n      this.range = 1,\r\n      this.sp = 60,\r\n      this.armor = 35,\r\n      this.mr = 20,\r\n      this.util = {\r\n        sp: 1000,\r\n      },\r\n      this.buff = [\r\n      ]\r\n      this.spell_pre = 30\r\n      this.spell_stage = 0\r\n      this.spell = function steel_tempest () {\r\n        if (this.status.target) {\r\n          let [x0,y0] = this.vm.getCoord(...this.pos)\r\n          let [x1,y1] = this.vm.getCoord(...this.status.target.pos)\r\n          let tgtLen = this.vm.getEuclid(x0, y0, x1, y1)\r\n          let info = PosInfo.board\r\n          if (this.spell_stage < 2) {\r\n            let len = info.w1*info.ratio*4\r\n            let xt = len/tgtLen*(x1-x0)+x0\r\n            let yt = len/tgtLen*(y1-y0)+y0\r\n            new util_yasuo_tempest(this.vm, this, [x0,y0], [xt,yt])\r\n            this.spell_stage ++\r\n          } else {\r\n            let len = info.w1*info.ratio*10\r\n            let x_len = (x1-x0)/tgtLen*len\r\n            let y_len = (y1-y0)/tgtLen*len\r\n            new util_yasuo_tornado(this.vm, this, x_len, y_len)\r\n            this.spell_stage = 0\r\n          }\r\n          this.status.spell = undefined\r\n          this.status.attack = 0\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  class Graves extends chess {\r\n    constructor (vm) {\r\n      super(vm)\r\n      this.id = 3,\r\n      this._name = '法外狂徒',\r\n      this.lvl = 0\r\n      this.size = 0.8,\r\n      this.cat = [0, 5],\r\n      this.src = 'Graves_d.png',\r\n      this.hp = 450,\r\n      this.mp = 0,\r\n      this._ad = 55,\r\n      this._as = 0.55,\r\n      this.range = 1,\r\n      this.sp = 60,\r\n      this.armor = 30,\r\n      this.mr = 20,\r\n      this.util = {\r\n        sp: 1000,\r\n      },\r\n      this.buff = [\r\n        new buff_graves_buckshot(this.vm, this)\r\n      ]\r\n    }\r\n  },\r\n\r\n  // class Aatrox extends chess {\r\n  //   constructor (vm) {\r\n  //     super(vm)\r\n  //     this.id = 4,\r\n  //     this._name = '暗裔剑魔',\r\n  //     this.lvl = 0\r\n  //     this.size = 0.8,\r\n  //     this.cat = [3, 6],\r\n  //     this.src = 'Aatrox.png',\r\n  //     this.hp = 700,\r\n  //     this.mp = 75,\r\n  //     this._ad = 65,\r\n  //     this._as = 0.65,\r\n  //     this.range = 1,\r\n  //     this.sp = 60,\r\n  //     this.armor = 25,\r\n  //     this.mr = 20,\r\n  //     this.util = {\r\n  //       sp: 1000,\r\n  //     },\r\n  //     this.buff = [\r\n  //     ]\r\n  //     this.spell_pre = 30\r\n  //     this.spell_stage = 0\r\n  //     this.spell = function the_darkin_blade () {\r\n  //       if (this.status.target) {\r\n          \r\n  //         let [x0,y0] = this.vm.getCoord(...this.pos)\r\n  //         let [x1,y1] = this.vm.getCoord(...this.status.target.pos)\r\n  //         let tgtLen = this.vm.getEuclid(x0, y0, x1, y1)\r\n  //         let info = PosInfo.board\r\n  //         if (this.spell_stage < 2) {\r\n  //           let len = info.w1*info.ratio*4\r\n  //           let xt = len/tgtLen*(x1-x0)+x0\r\n  //           let yt = len/tgtLen*(y1-y0)+y0\r\n  //           new util_yasuo_tempest(this.vm, this, [x0,y0], [xt,yt])\r\n  //           this.spell_stage ++\r\n  //         } else {\r\n  //           let len = info.w1*info.ratio*10\r\n  //           let x_len = (x1-x0)/tgtLen*len\r\n  //           let y_len = (y1-y0)/tgtLen*len\r\n  //           new util_yasuo_tornado(this.vm, this, x_len, y_len)\r\n  //           this.spell_stage = 0\r\n  //         }\r\n  //         this.status.spell = undefined\r\n  //         this.status.attack = 0\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // }\r\n]","import { buff_class_gun, buff } from \"./chess\";\r\n\r\nexport default [\r\n    {name: \"枪手\", stage: [2,4,6], buff: set_buff_class_gun},\r\n    {name: \"约德尔人\", stage: [3, 6]},\r\n    {name: \"贵族\", stage: [3, 6]},\r\n    {name: \"剑士\", stage: [3, 6, 9]},\r\n    {name: \"浪人\", stage: [1], exact: 0},\r\n    {name: \"海盗\", stage: [3]},\r\n    {name: \"恶魔\", stage: [2,4,6]},\r\n]\r\n\r\nexport function set_buff_class_gun (vm, camp, stage) {\r\n    let grids = vm.board.grid\r\n    for (let r in grids) {\r\n        for (let c in grids) {\r\n            if (grids[r][c] && grids[r][c].camp === camp && grids[r][c].cat.includes(0)) {\r\n                grids[r][c].buff.push(new buff_class_gun(vm, grids[r][c], stage))\r\n            }\r\n        }\r\n    }\r\n}","export default {\r\n    section: 'rgb(250, 250, 250)',\r\n    obj: 'rgb(100, 100, 100)',\r\n    cardText: 'rgb(66, 66, 66)',\r\n    reDealButton: 'rgb(199, 99, 99)',\r\n    upgradeButton: 'rgb(99, 99, 199)',\r\n    gold: '#ffd700',\r\n    chessHpBorder: 'rgb(66,66,66)',\r\n    chessHp: '#be8c19',\r\n    chessHpOppo: 'red',\r\n    chessMp: 'blue',\r\n    chessSp: '#ccc',\r\n}","import { buff_val } from \"./chess\"\r\n\r\nexport class equip {\r\n  constructor (vm) {\r\n    this.vm = vm\r\n    this.chess = undefined\r\n  }\r\n}\r\nexport default [\r\n  class rapid_firecannon extends equip {\r\n    constructor (vm) {\r\n      super(vm)\r\n      this.src = 'rapid_fire_cannon.png'\r\n      this.id = 0\r\n      this.name = '疾射火炮'\r\n    }\r\n    equipTo (chess) {\r\n      this.chess = chess\r\n      let buff0 = new buff_val(this.vm, this.chess, 'as', 0.4, 1, '攻速_疾射火炮')\r\n      let buff1 = new buff_val(this.vm, this.chess, 'range', 1, 1, '射程_疾射火炮')\r\n      this.chess.buff = this.chess.buff.concat([buff0, buff1])\r\n    }\r\n  }\r\n]","export const stage = [\r\n    'pvp',\r\n    'pvp'\r\n]\r\nexport const upgradeExp = [2, 2, 6, 10, 18, 30, 46, 70]","<template>\r\n  <div id=\"app\">\r\n    <div v-if='entry.inentry' class='entry'>\r\n      <div class='block' v-if=\"!entry.login\">\r\n        <input v-model='entry.name' placeholder=\"name\"><br>\r\n        <input v-model='entry.password' placeholder=\"password\"><br>\r\n        <div v-if=\"entry.error\">{{entry.error}}</div>\r\n        <button @click='login'>登录</button>\r\n        <button @click='signup'>注册</button>\r\n      </div>\r\n      <div class='block' v-if=\"entry.login && !entry.inroom\">\r\n        {{entry.name}}\r\n        <button @click='createRoom' v-show='entry.name'>创建房间</button>\r\n        <div v-if=\"entry.error\">{{entry.error}}</div>\r\n        <div class='block-list' v-show='entry.name'>\r\n        房间列表：\r\n          <div v-for=\"room in entry.rooms\" :key='room.id' :class='{disable:room.users.length>=2}' @click='joinRoom(room.id)'>\r\n            <span>{{room.users[0].name}}</span>\r\n            <span v-if=\"room.users[1]\">{{room.users[1].name}}</span>\r\n            <span v-if=\"!room.start\" class='span-right'>{{room.users.length}}/2 准备中</span>\r\n            <span v-if=\"room.start\" class='span-right'>第{{room.stage}}回合</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class='block' v-if=\"entry.inroom\">\r\n        {{entry.name}}\r\n        <div>房间中</div>\r\n        <div v-if=\"entry.error\">{{entry.error}}</div>\r\n        <div class='block-list'>\r\n          玩家列表：\r\n          <div v-for=\"u in entry.room.users\" :key='u.id'>{{u.name}}</div>\r\n        </div>\r\n        <button @click='startRoom' :disabled='entry.room.users.length<2'>开始</button>\r\n        <button @click='exitRoom'>退出</button>\r\n      </div>\r\n    </div>\r\n    <div v-if='!entry.inentry' class='game'>\r\n      <canvas id='canvas' style='width:100%;height:100%' :width='w' :height='h' @click='click' @mousemove=\"mousemove\"></canvas>\r\n      <div v-for='src in allsrc' :key='src' style='display:none'>\r\n        <img :src='src'>\r\n      </div>\r\n      <div class='show' v-if='showChess!==undefined' :style='{left:showPos[0],top:showPos[1]}'>\r\n        {{showChess.name}}\r\n        <div class='attr'>\r\n          <div>ad:</div><div>{{showChess.ad.toFixed(0)}}</div>\r\n          <div>as:</div><div>{{showChess.as.toFixed(2)}}</div>\r\n          <div>range:</div><div>{{showChess.range.toFixed(0)}}</div>\r\n          <div>armor:</div><div>{{showChess.armor.toFixed(0)}}</div>\r\n          <div>mr:</div><div>{{showChess.mr.toFixed(0)}}</div>\r\n        </div>\r\n        <div class='buff'>\r\n          <div v-for='(buff, index) in showChess.buff' :key='index'>\r\n            {{buff.name}}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CardInfo from './assets/card'\r\nimport ClassInfo from './assets/class'\r\nimport PosInfo from './assets/position'\r\nimport ChessInfo, { chess, buff_regainMana } from './assets/chess'\r\nimport ColorInfo from './assets/color'\r\nimport { setTimeout } from 'timers'\r\nimport { util_tgt, util_attack} from './assets/util'\r\nimport { randInt, removeFromArr, numberize, findArr } from './assets/helper'\r\nimport EquipInfo, { equip } from './assets/equip'\r\nimport { stage, upgradeExp } from './assets/script'\r\n\r\nexport default {\r\n  name: 'app',\r\n  data () {\r\n    return {\r\n      entry: {\r\n        inentry: true,\r\n        error: undefined,\r\n        name: '',\r\n        password: '',\r\n        login: false,\r\n        rooms: undefined,\r\n        inroom: false,\r\n        room: undefined,\r\n      },\r\n      fetchID: undefined,\r\n      canvas: undefined,\r\n      ctx: undefined,\r\n      w: 0,\r\n      h: 0,\r\n      mouse: {x:undefined, y:undefined},  // this coordinate is doubled\r\n      game: {\r\n        turn: 0,\r\n        gold: 100,\r\n        exp: 0,\r\n        lvl: 1,\r\n        costUpgrade: 4,\r\n        costRedeal: 2,\r\n        damageRecord: [],\r\n        grave: [],\r\n        classes: {},\r\n        schedule: {},\r\n        hp: 100,\r\n        enemy: undefined,\r\n        clickBoard: true,\r\n        combo: 0,\r\n      },\r\n      hold: undefined,\r\n      board: {\r\n        grid: undefined,\r\n      },\r\n      store: {\r\n        cards: new Array(5).fill(undefined)\r\n      },\r\n      hand: {\r\n        cards: new Array(9).fill(undefined)\r\n      },\r\n      equips: new Array(9).fill(undefined),\r\n      allsrc: [],\r\n      queue: [],\r\n      util: [],\r\n      showChess: undefined,\r\n      showPos: undefined,\r\n      ip: 'http://47.106.171.107:80/',\r\n      // ip: 'http://localhost:81/',\r\n    }\r\n  },\r\n  created () {\r\n    addEventListener('mousemove', e => {\r\n      this.mouse.x = e.clientX * 2\r\n      this.mouse.y = e.clientY * 2\r\n    })\r\n    this.initBoard()\r\n  },\r\n  mounted () {\r\n    this.fetchID = setInterval(this.fetchStatus, 3000)\r\n  },\r\n  computed: {\r\n    sortedRoomUsers () {\r\n      let users = this.entry.room.users\r\n      return users.sort((a,b) => a.hp - b.hp)\r\n    }\r\n  },\r\n  methods: {\r\n    /*\r\n      entry methods\r\n      */\r\n    getUserIndex (name) {\r\n      return this.entry.room.users.findIndex(v => v.name === name)\r\n    },\r\n    getEnemyIndex () {\r\n      return this.getUserIndex(this.game.enemy.name)\r\n    },\r\n    getMeIndex () {\r\n      return this.getUserIndex(this.entry.name)\r\n    },\r\n    dealError (error) {\r\n      console.log(error)\r\n    },\r\n    fetch (route, param) {\r\n      let formData = new FormData()\r\n      for (let k in param) {\r\n        formData.append(k, param[k])\r\n      }\r\n      return new Promise((resolve, reject) => {\r\n        fetch(this.ip+route, {\r\n          body: formData,\r\n          method: 'POST',\r\n        }).then(res => res.json())\r\n        .then(json => {\r\n          if (json.error) {\r\n            this.dealError(json)\r\n            reject()\r\n          }\r\n          else {resolve(json)}\r\n        })\r\n      })\r\n    },\r\n    login () {\r\n      let param = {name: this.entry.name, password: this.entry.password}\r\n      this.fetch('user/login', param).then(json => {\r\n        this.entry.login = true\r\n        if (json.start !== undefined) {\r\n          this.entry.inroom = true\r\n          this.entry.room = json\r\n        } \r\n      })\r\n    },\r\n    signup () {\r\n      let param = {name: this.entry.name, password: this.entry.password}\r\n      this.fetch('user/signup', param).then(json => {\r\n        this.entry.login = true\r\n      })\r\n    },\r\n    fetchStatus () {\r\n      if (this.entry.login) {\r\n        if (!this.entry.inroom) {\r\n          this.fetchRooms()\r\n        } else if (this.entry.inroom) {\r\n          this.fetchRoom()\r\n        }\r\n      }\r\n    },\r\n    fetchRooms () {\r\n      fetch(this.ip+'room/list').then(res => res.json()).then(json => {\r\n        this.entry.rooms = json\r\n      })\r\n    },\r\n    fetchRoom () {\r\n      let param = {roomid: this.entry.room.id}\r\n      this.fetch('room', param).then(json => {\r\n        this.entry.room = json\r\n        if (json.start) {\r\n          this.entry.inentry = false\r\n          clearInterval(this.fetchID)\r\n          // this.fetchID = setInterval(this.fetchGameStatus, 2000)\r\n          this.$nextTick(this.startGame)\r\n        }\r\n      })\r\n    },\r\n    joinRoom (id) {\r\n      let param = {name: this.entry.name, roomid: id}\r\n      this.fetch('room/join', param).then(json => {\r\n        this.entry.inroom = true\r\n        this.entry.room = json\r\n      })\r\n    },\r\n    exitRoom () {\r\n      let param = {name: this.entry.name, roomid: this.entry.room.id}\r\n      this.fetch('room/exit', param).then(json => {\r\n        this.entry.inroom = false\r\n        this.entry.rooms = json\r\n      })\r\n    },\r\n    createRoom () {\r\n      let param = {name: this.entry.name}\r\n      this.fetch('room/create', param).then(json => {\r\n        this.entry.inroom = true\r\n        this.entry.room = json\r\n      })\r\n    },\r\n    startRoom () {\r\n      let param = {roomid: this.entry.room.id}\r\n      this.fetch('room/start', param)\r\n    },\r\n    fetchGameStatus () {\r\n      let param = {roomid: this.entry.room.id}\r\n      this.fetch('room', param).then(json => {\r\n        this.entry.room = json\r\n        let room = this.entry.room\r\n        // if game end, return to the room\r\n        if (room.start = false) {\r\n          this.entry.inentry = true\r\n        }\r\n      })\r\n    },\r\n    /*\r\n      game main thread\r\n      */\r\n    startGame () {\r\n      this.w = document.documentElement.clientWidth*2\r\n      this.h = document.documentElement.clientHeight*2\r\n      this.canvas = document.getElementById('canvas')\r\n      this.ctx = this.canvas.getContext('2d')\r\n      this.deal()\r\n      this.main()\r\n      this.equips[0] = new EquipInfo[0]()\r\n      this.equips[1] = new EquipInfo[0]()\r\n      this.equips[2] = new EquipInfo[0]()\r\n      this.queue.push(this.actAll)\r\n    },\r\n    main () {\r\n      this.clearAll()\r\n      this.drawBoard()\r\n      this.drawHand()\r\n      this.drawStore()\r\n      this.drawHold()\r\n      this.drawUtil()\r\n      this.drawDamageRecord()\r\n      this.drawclasses()\r\n      this.drawEquips()\r\n      this.drawSchedule()\r\n      this.drawPlayers()\r\n      for (let i in this.queue) {\r\n        this.queue[i]()\r\n      }\r\n      this.schedule()\r\n      window.requestAnimationFrame(this.main)\r\n    },\r\n    schedule () {\r\n      let s = this.game.schedule\r\n      let grids = this.board.grid\r\n      let OK = false // flag for transimission done\r\n      // preparing stage\r\n      if (s.status === 'prepare') {\r\n        if (s.p === 0) {\r\n          this.fetchGameStatus()\r\n          this.updateGold()\r\n          this.updateExp()\r\n        }\r\n        else if (s.p < s.pn) {\r\n        }\r\n        else if (s.p === s.pn) {\r\n          // collect data and upload to server\r\n          this.game.clickBoard = false\r\n          let data = {grids:[], hand: [], equip: []}\r\n          for (let r in grids) {\r\n            for (let c in grids) {\r\n              if (grids[r][c] !== undefined) {\r\n                let d = {pos:[r,c], id:grids[r][c].id, lvl: grids[r][c].lvl}\r\n                if (grids[r][c].equips) {\r\n                  d.equip = []\r\n                  for (let i in grids[r][c].equips) {\r\n                    d.equip.push(grids[r][c].equips[i].id)\r\n                  }\r\n                }\r\n                data.grids.push(d)\r\n              }\r\n            }\r\n          }\r\n          for (let i in this.hand.cards) {\r\n            if (this.hand[i] !== undefined) {\r\n              data.hand.push(this.hand[i].id)\r\n            }\r\n          }\r\n          for (let i in this.equips) {\r\n            if (this.equips[i] !== undefined) {\r\n              data.equip.push(this.equips[i].id)\r\n            }\r\n          }\r\n          let param = {roomid: this.entry.room.id, name: this.entry.name, data: JSON.stringify(data)}\r\n          this.fetch('data/start', param).then(json => {\r\n            this.setChessByData(JSON.parse(json.data), 1)\r\n            this.game.enemy = json\r\n            this.game.schedule = {status: 'battle', p: 0, pn: 100000}\r\n            this.startRound()\r\n          })\r\n        }\r\n        else if (s.p > s.pn) {\r\n        }\r\n        s.p ++\r\n      } else if (s.status === 'battle') {\r\n        if (s.p == s.pn) {\r\n          let param = {roomid: this.entry.room.id, name: this.entry.name, hp: this.game.hp}\r\n          this.fetch('data/end', param).then(json => {\r\n            console.log(json)\r\n            this.initBoard()\r\n            this.setChessByData(JSON.parse(json.data), 0)\r\n            this.game.schedule = {status: 'prepare', p: 0, pn: 300}\r\n            this.game.clickBoard = true\r\n          })\r\n        } else if (s.p > 1) {\r\n        }\r\n        s.p++\r\n      } else {\r\n        this.game.schedule = {status: 'prepare', p: 0, pn: 300}\r\n      }\r\n    },\r\n    /*\r\n      init functions\r\n      */\r\n    initBoard () {\r\n      let tmp = new Array(6).fill(undefined)\r\n      this.board.grid = tmp.map(v => new Array(7).fill(undefined))\r\n    },\r\n    /*\r\n      user actions\r\n      */\r\n    mousemove (e) {\r\n      if (this.hold) {\r\n        this.showChess = undefined\r\n        this.showPos = undefined\r\n        return\r\n      }\r\n      let x = e.clientX*2\r\n      let y = e.clientY*2\r\n      let pos = this.getPosByCoord(x, y)\r\n      if (pos) {\r\n        let [j, i] = pos\r\n        if (this.board.grid[j][i]) {\r\n          this.showChess = this.board.grid[j][i]\r\n          this.showPos = [x/2+1+'px', y/2+1+'px']\r\n          return\r\n        }\r\n      }\r\n      this.showChess = undefined\r\n      this.showPos = undefined\r\n    },\r\n    click (e) {\r\n      let x = e.clientX*2\r\n      let y = e.clientY*2\r\n      // click board\r\n      let pos = this.getPosByCoord(x, y)\r\n      if (this.game.clickBoard && pos) {\r\n        let [j, i] = pos\r\n        // if hold a equipment, equit it to the chess\r\n        if (this.hold instanceof equip) {\r\n          if (this.board.grid[j][i]) {\r\n            this.equiping(this.board.grid[j][i])\r\n          }\r\n        } else {\r\n          this.setChess(j, i)\r\n        }\r\n      }\r\n      // click hand\r\n      let info = PosInfo.hand\r\n      if (x>this.w/2-info.w/2 && x<this.w/2+info.w/2 && y>info.marTop && y<info.marTop+info.h) {\r\n        if ((x-(this.w/2-info.w/2)) % (info.sp+info.w1) < info.sp || (y-info.marTop) % (info.w1+info.sp) < info.sp) return // blank space\r\n        let index = Math.floor((x-(this.w/2-info.w/2))/(info.sp+info.w1))\r\n        if (this.hold instanceof equip) {\r\n          if (this.hand.cards[index]) {\r\n            this.equiping(this.hand.cards[index])\r\n          }\r\n        }\r\n        else {\r\n          let cards = this.hand.cards\r\n          let tmp = this.hold\r\n          this.hold = cards[index]\r\n          cards[index] = tmp\r\n        }\r\n      }\r\n      // click store\r\n      info = PosInfo.store\r\n      if (x>this.w/2-info.w/2 && x<this.w/2+info.w/2 && y>this.h-info.h && y<this.h) {\r\n        let left = x-(this.w/2-info.w/2)\r\n        let top = y-(this.h-info.h)\r\n        if (left%(info.w1+info.sp)<info.sp || top%(info.w1+info.sp)<info.sp) return\r\n        else if (left < info.w1+info.sp) {\r\n          if (top%(info.bh+info.sp)<info.sp) return\r\n          else if (Math.floor(top/(info.bh+info.sp)) == 1) {\r\n            this.buyDeal()\r\n          } else if (Math.floor(top/(info.bh+info.sp)) == 2) {\r\n            this.buyUpgrade()\r\n          }\r\n        }\r\n        else {\r\n          let buy = Math.floor(left / (info.w1+info.sp)) - 1\r\n          this.buyCard(buy)\r\n        }\r\n      }\r\n      //click equip\r\n      info = PosInfo.equips\r\n      if (x>info.l && x<info.l+info.h && y>info.t && y<info.t+info.h*this.equips.length) {\r\n        let index = Math.floor((y-info.t)/info.h)\r\n        if (!this.hold || this.hold instanceof equip) {\r\n          let tmp = this.hold\r\n          this.hold = this.equips[index]\r\n          this.equips[index] = tmp\r\n        }\r\n      }\r\n    },\r\n    /*\r\n      store related functions\r\n      */\r\n    deal () {\r\n      for (let i = 0; i < 5; i++) {\r\n        let cardId = Math.floor(Math.random()*CardInfo.length)\r\n        this.store.cards[i] = CardInfo[cardId]\r\n      }\r\n    },\r\n    addExp (exp) {\r\n      if (this.game.lvl >= 9) return false\r\n      let require = upgradeExp[this.game.lvl-1]\r\n      this.game.exp = this.game.exp + this.game.costUpgrade\r\n      if (this.game.exp >= require) {\r\n        this.game.exp = this.game.lvl == 8 ? 0 : this.game.exp - require\r\n        this.game.lvl ++\r\n      }\r\n      return true\r\n    },\r\n    buyDeal () {\r\n      console.log('bb')\r\n      if (this.game.gold >= this.game.costRedeal) {\r\n        this.game.gold -= this.game.costRedeal\r\n        this.deal()\r\n      }\r\n    },\r\n    buyUpgrade () {\r\n      if (this.game.gold >= this.game.costUpgrade) {\r\n        if (this.addExp(this.game.costUpgrade)) {\r\n          this.game.gold -= this.game.costUpgrade\r\n        }\r\n      }\r\n    },\r\n    buyCard(storeId) {\r\n      let wannaBuy = this.store.cards[storeId]\r\n      if (this.game.gold >= wannaBuy.cost) {\r\n        this.store.cards[storeId] = undefined\r\n        this.game.gold -= wannaBuy.cost\r\n        this.addChess(wannaBuy.id)\r\n      }\r\n    },\r\n    updateGold () {\r\n      let base = 5\r\n      if (this.entry.room.stage < 2) base = 2\r\n      else if (this.entry.room.stage < 4) base = parseInt(this.entry.room.stage)\r\n      let interest = Math.min(Math.floor(this.game.gold / 10), 5)\r\n      let combo = Math.min(Math.floor(this.game.combo / 2), 3)\r\n      this.game.gold += (base + interest + combo)\r\n    },\r\n    updateExp () {\r\n      this.addExp(2)\r\n    },\r\n    /*\r\n      game procedure\r\n      */\r\n    startRound () {\r\n      this.queue.push(this.checkRemain)\r\n      this.initAllChess()\r\n    },\r\n    actAll () {\r\n      let grid = this.board.grid\r\n      for (let i in grid) {\r\n        for (let j in grid[i]) {\r\n          if (grid[i][j] !== undefined) {\r\n            let chess = grid[i][j]\r\n            if (chess.status.ready) {\r\n              // res[0] nearest coordinate [r,c], undefined if no nearest\r\n              // res[1] nearest distance, 100 if no nearest\r\n              let res = this.findNearestOppo(chess, i, j)\r\n              let nearestPos = res[0]\r\n              let nearestDis = res[1]\r\n              if (nearestPos !== undefined) {\r\n                if (nearestDis <= chess.range) {\r\n                  chess.status.ready=undefined\r\n                  chess.status.attack=0\r\n                  chess.status.target=grid[nearestPos[0]][nearestPos[1]]\r\n                } else {\r\n                  // if target out of range, chess moves toward it for one step, then check best target again. So, no need to fix any target.\r\n                  if (this.moveChess(chess, nearestPos)) {\r\n                    chess.status.ready=undefined\r\n                    chess.status.move = 0\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            else if (chess.status.attack >= 0)  {\r\n              // if target been destroyed (set to undefined)\r\n              if (chess.status.target !== undefined && chess.status.target.status.dead) {\r\n                chess.status.ready = true\r\n                chess.status.attack = undefined\r\n                chess.status.target = undefined\r\n              } else if (this.getDistance(...chess.pos, ...chess.status.target.pos) > chess.range) {\r\n                if (this.moveChess(chess, chess.status.target.pos)) {\r\n                  chess.status.move = 0\r\n                }  // same, moveOnce, and find other best target\r\n                chess.status.attack = undefined\r\n                chess.status.target = undefined\r\n              } else {\r\n                let attackTime = 1/chess.as*1000\r\n                chess.status.attack += 16\r\n                if (chess.status.attack >= attackTime) {\r\n                  chess.status.attack = 0\r\n                  this.dealBuff('attack', chess)\r\n                  this.createUtilAttack(chess, chess.status.target)\r\n                  if (chess._mp >= chess.mp) {  // 攻击完成后才会施法\r\n                    this.castSpell(chess)\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            else if (chess.status.move >= 0) {\r\n              chess.status.move ++\r\n              if (chess.status.move >= chess.sp) {\r\n                chess.status.move = undefined\r\n                chess.status.ready = true\r\n              }\r\n            }\r\n            else if (chess.status.jump) {\r\n              let jump = chess.status.jump\r\n              if (jump.p === 0) {\r\n                if (grid[jump.tgt[0]][jump.tgt[1]] === undefined) {\r\n                  grid[chess.pos[0]][chess.pos[1]] = undefined\r\n                  grid[jump.tgt[0]][jump.tgt[1]] = chess\r\n                  chess.pos = jump.tgt\r\n                }\r\n                jump.p ++\r\n              }\r\n              else if (jump.p >= jump.pn) {\r\n                chess.status.jump = undefined\r\n                if (chess.status.target) {\r\n                  chess.status.attack = 0\r\n                }\r\n              }\r\n              else {\r\n                jump.p ++\r\n              }\r\n            }\r\n            else if (chess.status.spell >= 0) {\r\n              if (chess.status.spell < chess.spell_pre) {\r\n                chess.status.spell ++\r\n              } else {\r\n                chess.status.spell = undefined\r\n                chess.spell()\r\n              }\r\n            }\r\n            else if (chess.status.stun) {\r\n              let stun = chess.status.stun\r\n              if (stun.p<stun.pn) {\r\n                stun.p++\r\n              } else {\r\n                chess.status.stun = undefined\r\n                chess.status.ready = true\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      let util = this.util\r\n      for (let i in util) {\r\n        if (util[i].status.prepare || util[i].status.done) {\r\n          util[i].act()\r\n        } else if (util[i].status.ready) {\r\n          util[i].effect()\r\n        }\r\n      }\r\n    },\r\n    equiping (chess) {\r\n      if (chess && this.hold instanceof equip) {\r\n        chess.equip(this.hold)\r\n        this.hold = undefined\r\n      }\r\n    },\r\n    // if chess cannot move, return false\r\n    moveChess (chess, finalTarget) {\r\n      let path = this.getPath(chess, finalTarget)\r\n      if (path === undefined) {\r\n        return false\r\n      }\r\n      let tgt = path[0]\r\n      let grid = this.board.grid\r\n      if (grid[tgt[0]][tgt[1]] === undefined) {// for ensurance, tgt should be undefined as it's selected by path-finding func.\r\n        chess.orient = this.getOrient(...chess.pos, ...tgt)\r\n        grid[chess.pos[0]][chess.pos[1]] = undefined\r\n        grid[tgt[0]][tgt[1]] = chess\r\n        chess.pos = tgt\r\n        chess.status.move = true\r\n      }\r\n      return true\r\n    },\r\n    // transition into pre_spell stage\r\n    castSpell (chess) {\r\n      if (chess.spell) {\r\n        chess.status.attack = undefined\r\n        chess.status.spell = 0\r\n        chess._mp = 0\r\n      }\r\n    },\r\n    damage (util, tgt=undefined) {\r\n      if (!tgt) tgt = util.tgt\r\n      // compute mitigated damage\r\n      let damage = util.damage\r\n      if (util.type === 0) {\r\n        damage = this.mitigate(tgt.armor) * damage\r\n      } else if (util.type === 1) {\r\n        damage = this.mitigate(tgt.mr) * damage\r\n      }\r\n      // add damage to record\r\n      let record = this.game.damageRecord\r\n      if (util.src.camp === 0) {\r\n        let intDamage = Math.round(damage)\r\n        let pair = record.find(x => {return x.id === util.src.id})\r\n        if (pair) {\r\n          pair.val += intDamage\r\n        } else {\r\n          record.push({id: util.src.id, val: intDamage})\r\n        }\r\n        record.sort((a,b) => {a.val < b.val})\r\n      }\r\n      // deal damage\r\n      tgt._hp -= damage\r\n      // deal buffs\r\n      this.dealBuff('damage', tgt, util.damage, util)  // use pre-mitigated damage\r\n      // check vital status\r\n      if (tgt._hp <= 0) {\r\n        tgt.die()\r\n      }\r\n    },\r\n    stun (util, tgt=undefined) {\r\n      if (!tgt) {\r\n        tgt = util.target\r\n      }\r\n      // stunning shouldn't stop jump\r\n      tgt.status.attack = undefined\r\n      tgt.status.spell = undefined\r\n      tgt.status.ready = undefined\r\n      tgt.status.stun = {type:util.stun_type,p:0,pn:util.stun}\r\n    },\r\n    mitigate (n) {\r\n      return 100 / (n + 100)\r\n    },\r\n    dealBuff (type, ...args) {\r\n      if (type === 'damage') {\r\n        let [chess, val, util] = args\r\n        for (let i in chess.buff) {\r\n          chess.buff[i].response(type, val, util)\r\n        }\r\n      } else if (type === 'attack') {\r\n        let [chess] = args\r\n        for (let i in chess.buff) {\r\n          chess.buff[i].response(type)\r\n        }\r\n      }\r\n    },\r\n    checkRemain () {\r\n      let grid = this.board.grid\r\n      let camp0 = 0\r\n      let camp1 = 0\r\n      for (let i in grid) {\r\n        for (let j in grid[i]) {\r\n          if (grid[i][j] === undefined) continue\r\n          else if (grid[i][j].camp === 0) camp0++\r\n          else if (grid[i][j].camp === 1) camp1++\r\n        }\r\n      }\r\n      if (camp0 > 0 && camp1 > 0) return\r\n      removeFromArr(this.queue, this.checkRemain)\r\n      let damage = 0\r\n      // lose\r\n      if (camp0 === 0) {\r\n        damage = camp1 * 2\r\n        if (this.game.hp - damage < 0) {\r\n          this.hp = 0\r\n        } else {\r\n          this.game.hp -= damage\r\n        }\r\n        this.game.combo = this.game.combo >= 0 ? -1 : this.game.combo - 1\r\n      }\r\n      else if (camp1 === 0) {\r\n        this.game.combo = this.game.combo <= 0 ? 1 : this.game.combo + 1\r\n      }\r\n      if (this.game.schedule.status === 'battle') {\r\n        this.game.schedule.p = this.game.schedule.pn\r\n      }\r\n    },\r\n    // initialize all chesses at this round start\r\n    initAllChess () {\r\n      let grid = this.board.grid\r\n      for (let i in grid) {\r\n        for (let j in grid[i]) {\r\n          let g = grid[i][j]\r\n          if (g !== undefined) {\r\n            g.status.ready = true\r\n            g.orient = 0\r\n            g._hp = g.hp\r\n            if (g.mp) {\r\n              g._mp = 0\r\n              console.log(g.buff)\r\n              g.buff.push(new buff_regainMana(this, g))\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.game.classes = this.updateClasses(0)\r\n      this.game.oppoClasses = this.updateClasses(1)\r\n      this.initClassBuffs(0)\r\n      this.initClassBuffs(1)\r\n    },\r\n    updateClasses (camp) {\r\n      let grids = this.board.grid\r\n      let classes = {}\r\n      let info = ClassInfo\r\n      let chessNames = []\r\n      for (let r in grids) {\r\n        for (let c in grids) {\r\n          if (grids[r][c] !== undefined && grids[r][c].camp === camp && chessNames.indexOf(grids[r][c].name) < 0) {\r\n            chessNames.push(grids[r][c].name)\r\n            grids[r][c].cat.map(v => {\r\n              if (v in classes) {classes[v].n++}\r\n              else {classes[v] = {n:1}}\r\n            })\r\n          }\r\n        }\r\n      }\r\n      for (let c in classes) {\r\n        for (let s in info[c].stage) {\r\n          if (info[c].exact && info[c].stage[s] === classes[c].n) {\r\n            classes[c].active = s\r\n          } else if (!info[c].exact) {\r\n            if (info[c].stage[s] <= classes[c].n) {\r\n              classes[c].active = s\r\n            } else {\r\n              break\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return classes\r\n    },\r\n    initClassBuffs (camp) {\r\n      let classes = camp === 0 ? this.game.classes : this.game.oppoClasses\r\n      for (let c in classes) {\r\n        if (classes[c].active) {\r\n          if (ClassInfo[c].buff) {  // note: all class has buff, this check is for development safety\r\n            ClassInfo[c].buff(this, camp, classes[c].active)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    setChessByData (data, camp) {   // camp 0 friend, camp 1 enemy\r\n      let grids = data.grids\r\n      for (let i in grids) {\r\n        let chess = grids[i]\r\n        let r,c\r\n        if (camp === 1) {\r\n          r = 5-chess.pos[0]\r\n          c = 6-chess.pos[1]\r\n        } else {\r\n          r = chess.pos[0]\r\n          c = chess.pos[1]\r\n        }\r\n        this.setChess(r, c, this.createChess(chess.id, camp))\r\n        if (chess.equip) {\r\n          for (let j in chess.equip) {\r\n            this.board.grid[r][c].equip(new EquipInfo[chess.equip[j]]())\r\n          }\r\n        }\r\n      }\r\n    },\r\n    /*\r\n      game inline functions\r\n      */\r\n    // orient start: top-left 0\r\n    getPosByCoord (x, y) {\r\n      let info = PosInfo.board\r\n      if (x>this.w/2-info.w/2 && x<this.w/2+info.w/2 && y>info.marTop && y<info.marTop+info.h) {\r\n        // x,y relative position to board centre\r\n        let rx = x-this.w/2\r\n        let ry = y-(info.h/2+info.marTop)\r\n        let w = info.w1\r\n        let k = Math.tan(Math.PI/6)\r\n        let ratio = info.ratio\r\n        // a,b,c are 3d index\r\n        let a = Math.floor((ry+k*rx)/w)+8\r\n        let b = Math.floor((ry-k*rx+w/2)/w)+7\r\n        let c = Math.floor((rx+ratio/2*w)/(ratio*w))+7\r\n        // j row index, i col index\r\n        let j = Math.floor((a+b-7+1)/3)\r\n        let i = Math.floor((c-(j%2+0.5)+1)/2)\r\n        // out of grids\r\n        if (i < 0 || i > 6 || j < 0 || j > 5) return\r\n        return [j, i]\r\n      }\r\n    },\r\n    getOrient (r1,c1, r2,c2) {\r\n      if (r1===r2) {\r\n        return c1<c2?2:5\r\n      } else {\r\n        if (r1%2==1) {\r\n          if (r2<r1) {\r\n            return c1===c2?0:1\r\n          } else {\r\n            return c1===c2?4:3\r\n          }\r\n        } else {\r\n          if (r2<r1) {\r\n            return c1===c2?1:0\r\n          } else {\r\n            return c1===c2?3:4\r\n          }\r\n        }\r\n      }\r\n    },\r\n    getOrientGrid (now, orient) {\r\n      let pos = []\r\n      let odd = now[0]%2\r\n      if (orient < 2) {\r\n        pos[0] = now[0] - 1\r\n        pos[1] = odd?now[1]+orient:now[1]+orient-1\r\n      } else if (orient == 3 || orient == 4) {\r\n        pos[0] = now[0] + 1\r\n        pos[1] = odd?now[1]+4-orient:now[1]+3-orient\r\n      } else {\r\n        pos = [now[0], orient === 2 ? now[1]+1:now[1]-1]\r\n      }\r\n      if (pos[0] < 0 || pos[0] > 5 || pos[1] < 0 || pos[1] > 6) return undefined\r\n      return pos\r\n    },\r\n    samePos (a, b) {\r\n      return a[0] === b[0] && a[1] === b[1]\r\n    },\r\n    getPathNode (now, tgt, open, close, displayflag) {\r\n      if (displayflag) console.log(now)\r\n      close.push(now)\r\n      // get six adjacent, test if each is OK, add OK to ablePos and global open, compute OK distance\r\n      let sixPos = this.getSixPos(now)\r\n      let avails = []\r\n      for (let i in sixPos) {\r\n        let pos = sixPos[i]\r\n        if (this.samePos(tgt, pos)) return [pos]\r\n        if (this.board.grid[pos[0]][pos[1]] !== undefined) {\r\n          continue\r\n        }\r\n        let flag = false\r\n        for (let j in close) {\r\n          if (this.samePos(close[j], pos)) {flag = true; break}\r\n        }\r\n        if (flag) continue\r\n        avails.push({pos: pos, d:this.getDistance(...pos,...tgt)})\r\n      }\r\n      if (avails.length === 0) {\r\n        return undefined\r\n      }\r\n      // sort and search begin with smallest d\r\n      avails.sort((a,b)=>a.d-b.d)\r\n      let paths = []\r\n      let minD = -1                     // nextNode with same weight should all been tested\r\n      for (let i in avails) {\r\n        if (avails[i].d !== minD) {\r\n          minD = avails[i].d\r\n          if (paths.length > 0) {\r\n            break\r\n          }\r\n        }\r\n        let res = this.getPathNode(avails[i].pos, tgt, open, close.slice(), displayflag)\r\n        if (res) {\r\n          res.unshift(avails[i].pos)    // unshift only return new-length\r\n          paths.push(res)               // save result path\r\n        }\r\n      }\r\n      if (paths.length > 0) {\r\n        let ret_path = this.getShortestPath(paths)\r\n        return ret_path\r\n      }\r\n      else return undefined\r\n    },\r\n    getShortestPath (paths) {\r\n      let minLen = 100\r\n      let minInd = -1\r\n      for (let j in paths) {\r\n        if (paths[j].length < minLen) {\r\n          minLen = paths[j].length\r\n          minInd = j\r\n        }\r\n      }\r\n      return paths[minInd]\r\n    },\r\n    getPath (chess, target) {\r\n      let tgt = numberize(target)\r\n      let open = []\r\n      let close = []\r\n      let flag = this.samePos(chess.pos, [-1,-1]) ? true : false\r\n      return this.getPathNode(chess.pos, tgt, open, close, flag)\r\n    },\r\n    getSixPos(cen) {\r\n      cen = numberize(cen)\r\n      let dir = cen[0]%2===1 ? [[-1,0],[-1,1],[0,1],[1,1],[1,0],[0,-1]] : [[-1,-1],[-1,0],[0,1],[1,0],[1,-1],[0,-1]]\r\n      let sixPos = []\r\n      for (let i in dir) {\r\n        let v = dir[i]\r\n        let r = cen[0]+v[0]\r\n        let c = cen[1]+v[1]\r\n        if (r<0||r>5||c<0||c>6) continue\r\n        sixPos.push([r,c])\r\n      }\r\n      return sixPos\r\n    },\r\n    getCoord (r, c) {\r\n      [r, c] = numberize([r, c])\r\n      let w1 = PosInfo.board.w1\r\n      let x = PosInfo.board.ratio * w1 * 2 * c + (r%2) * w1\r\n      let y = r*3/2*w1\r\n      return [x, y]\r\n    },\r\n    getEuclid (x1, y1, x2, y2) {\r\n      return Math.sqrt(Math.pow(x1-x2, 2) + Math.pow(y1-y2, 2))\r\n    },\r\n    getDistance (a, b, c, d) {\r\n      [a,b,c,d] = numberize([a,b,c,d])\r\n      let colD = undefined\r\n      let rowD = Math.abs(a-c)\r\n      let k = Math.ceil(rowD/2)\r\n      let u = undefined\r\n      let l = undefined\r\n      let dis = undefined\r\n      if (a%2 === c%2) {\r\n        u = b+k\r\n        l = b-k\r\n      } else if (a%2 === 1) {\r\n        u = b+k\r\n        l = b-k+1\r\n      } else if (c%2 === 1) {\r\n        u = b+k-1\r\n        l = b-k\r\n      }\r\n      if (d<=u && d>=l) {\r\n        colD = 0\r\n      } else if (d>u) {\r\n        colD = d-u\r\n      } else if (d<l) {\r\n        colD = l-d\r\n      }\r\n      dis = colD + rowD\r\n      return dis\r\n    },\r\n    findNearestOppo (chess, r, c) {\r\n      let grid = this.board.grid\r\n      let minDis = 100\r\n      let minSet = []\r\n      let nearest = undefined\r\n      for (let i in grid) {\r\n        for (let j in grid[i]) {\r\n          if (grid[i][j] !== undefined) {\r\n            if (grid[i][j].camp !== chess.camp) {\r\n              let dis = this.getDistance(r,c, i,j)\r\n              if (dis < minDis) {\r\n                minDis = dis\r\n                minSet = [[i,j]]\r\n              } else if (dis == minDis) {\r\n                minSet.push([i,j])\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (minSet.length > 1) {\r\n        nearest = minSet[randInt(minSet.length)]\r\n      } else {\r\n        nearest = minSet[0]\r\n      }\r\n      if (nearest) {\r\n        nearest = numberize(nearest)\r\n      }\r\n      return [nearest, minDis]\r\n    },\r\n    setGrid (i, j, chess) {\r\n      if (chess !== undefined) {  // if undefined is set to this grid\r\n        chess.pos = [i, j]\r\n      }\r\n      this.board.grid[i][j] = chess\r\n    },\r\n    setChess (j, i, chess=undefined) {\r\n      let grid = this.board.grid\r\n      // camp=0 friend, camp=1 opponent\r\n      if (chess === undefined) {  // swap hold and grid[i][j]\r\n        if (j <= 2) return        // cannot set at j<=2\r\n        let tmp = this.hold\r\n        this.hold = grid[j][i]\r\n        this.setGrid(j, i, tmp)\r\n      } else {  // system auto set\r\n        this.setGrid(j, i, chess)\r\n      }\r\n    },\r\n    addChess (cardId) {\r\n      let cards = this.hand.cards\r\n      for (let i in cards) {\r\n        if (cards[i] === undefined) {\r\n          cards[i] = this.createChess(cardId, 0)\r\n          if (this.allsrc.indexOf(cards[i].src) < 0) {\r\n            this.allsrc.push(cards[i].src)// create img element enable ctx.drawImage()\r\n          }\r\n          break\r\n        }\r\n      }\r\n    },\r\n    createChess (id, camp) {\r\n      let obj = new ChessInfo[id](this)\r\n      obj.hold = false         // init hold\r\n      obj.pos = undefined\r\n      obj.status = {}\r\n      obj.camp = camp\r\n      obj.equips = []\r\n      return obj\r\n    },\r\n    createUtilAttack (src, tgt) {\r\n      let u = new util_attack(this, src, tgt)\r\n    },\r\n    /*\r\n      draw functions\r\n      */\r\n    clearAll () {\r\n      let ctx = this.ctx\r\n      ctx.clearRect(0, 0, this.w, this.h)\r\n    },\r\n    drawUtil () {\r\n      let util = this.util\r\n      let ctx = this.ctx\r\n      let info = PosInfo.board\r\n      let xbase = this.w/2-6.5*info.ratio*info.w1\r\n      let ybase = info.marTop+info.h/2-3.75*info.w1\r\n      for (let i in util) {\r\n        util[i].draw(ctx, xbase, ybase)\r\n      }\r\n    },\r\n    drawBoard () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.board\r\n      let grid = this.board.grid\r\n      const bMarTop = info.marTop\r\n      const bw = info.w\r\n      const bh = info.h\r\n      const w1 = info.w1\r\n      const w2 = info.w2\r\n      const ratio = info.ratio\r\n      ctx.fillStyle = ColorInfo.section\r\n      ctx.fillRect(this.w/2-bw/2, bMarTop, bw, bh)\r\n      for (let i in grid) {\r\n        let bias = i % 2 == 1 ? bias = ratio*w1/2 : -ratio*w1/2\r\n        let cenT = bh/2+bMarTop+(i-2.5)*1.5*w1\r\n        for (let j in this.board.grid[i]) {\r\n          let cenL = this.w/2+(j-3)*ratio*2*w1+bias\r\n          ctx.beginPath()\r\n          for (let k =0; k < 6; k++) {\r\n            let rad = Math.PI*(1/3*k-1/6)\r\n            let x = Math.cos(rad) * w1\r\n            let y = Math.sin(rad) * w1\r\n            this.ctx.lineTo(cenL+x, cenT+y)\r\n          }\r\n          ctx.closePath()\r\n          ctx.strokeStyle = ColorInfo.obj\r\n          ctx.stroke()\r\n          let chess = grid[i][j]\r\n          if (chess !== undefined) {\r\n            let biasX=0, biasY=0\r\n            // status:move position bias\r\n            if (chess.status.move >= 0) {\r\n              let rad = (5-chess.orient)*Math.PI/3\r\n              let biasD = ratio*2*w1*(1-chess.status.move/chess.sp)\r\n              biasX = biasD * Math.cos(rad)\r\n              biasY = -biasD * Math.sin(rad)\r\n            }\r\n            // status:jump position bias\r\n            if (chess.status.jump) {\r\n              let jump = chess.status.jump\r\n              let [x0, y0] = this.getCoord(...jump.src)\r\n              let [x1, y1] = this.getCoord(...jump.tgt)\r\n              biasX = -(x1-x0)*(1-jump.p/jump.pn)\r\n              biasY = -(y1-y0)*(1-jump.p/jump.pn)\r\n            }\r\n            // img\r\n            let img = new Image()\r\n            img.src = chess.src\r\n            let imgW = chess.size * w2\r\n            ctx.drawImage(img, cenL-imgW/2+biasX, cenT-imgW/2+biasY, imgW, imgW)\r\n            // hp mp\r\n            ctx.fillStyle = chess.camp===0 ? ColorInfo.chessHp:ColorInfo.chessHpOppo\r\n            ctx.fillRect(cenL-info.hpW/2+biasX, cenT-info.hpT+biasY, chess._hp/chess.hp*info.hpW, info.hpH)\r\n            ctx.fillStyle = ColorInfo.chessMp\r\n            ctx.fillRect(cenL-info.hpW/2+biasX, cenT-info.mpT+biasY, chess._mp/chess.mp*info.hpW, info.hpH)\r\n            if (chess.status.spell) {\r\n              ctx.fillStyle = ColorInfo.chessSp\r\n              ctx.fillRect(cenL-info.hpW/2+biasX, cenT-info.spT+biasY, chess.status.spell/chess.spell_pre*info.hpW, info.hpH)\r\n            }\r\n            if (chess.status.stun) {\r\n              if (chess.status.stun.type===0) {\r\n                let startAngle = Math.PI*2*(chess.status.stun.p%36)/36\r\n                ctx.strokeStyle = '#666'\r\n                ctx.lineWidth = 4\r\n                ctx.beginPath()\r\n                ctx.arc(cenL+biasX, cenT-50+biasY, 20, startAngle, Math.PI*5/3+startAngle)\r\n                ctx.stroke()\r\n                ctx.lineWidth = 1\r\n              }\r\n            }\r\n            // buff\r\n            for (let i in chess.buff) {\r\n              if (chess.buff[i].draw) {\r\n                chess.buff[i].draw(ctx, cenL+biasX, cenT+biasY)\r\n              }\r\n            }\r\n            for (let i in chess.equips) {\r\n              let img = new Image()\r\n              img.src = chess.equips[i].src\r\n              let imgR = info.w2/2*chess.size\r\n              let equipR = info.wEquip * chess.size\r\n              ctx.drawImage(img, cenL-imgR+biasX+equipR*i, cenT+imgR+biasY, equipR, equipR)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    drawHand () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.hand\r\n      const cw = info.w1\r\n      const sp = info.sp\r\n      const hw = info.w\r\n      const hh = info.h\r\n      const handT = info.marTop\r\n      let handL = this.w/2-hw/2\r\n      let cards = this.hand.cards\r\n      ctx.fillStyle = ColorInfo.section\r\n      ctx.fillRect(handL, handT, hw, hh)\r\n      for (let i in cards) {\r\n        ctx.strokeStyle = ColorInfo.obj\r\n        let cardL = this.w / 2 + (i-4-0.5)*cw+(i-4)*sp\r\n        let cardT = handT + sp\r\n        ctx.strokeRect(cardL, cardT, cw, cw)\r\n        if (cards[i]) {\r\n          let img = new Image()\r\n          img.src = cards[i].src\r\n          ctx.drawImage(img, cardL, cardT, cw, cw)\r\n          for (let j in cards[i].equips) {\r\n            let img = new Image()\r\n            img.src = cards[i].equips[j].src\r\n            ctx.drawImage(img, cardL+info.wEquip*j, cardT+cw-info.wEquip, info.wEquip, info.wEquip)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    drawStore () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.store\r\n      const bw = info.w\r\n      const bh = info.h\r\n      const cw = info.w1\r\n      const sp = info.sp\r\n      const bth = info.bh\r\n      let strL = this.w/2-bw/2\r\n      let strT = this.h-bh\r\n      ctx.fillStyle = ColorInfo.section\r\n      ctx.fillRect(strL, strT, bw, bh)\r\n      let cards = this.store.cards\r\n      for (let i in cards) {\r\n        ctx.strokeStyle = ColorInfo.obj\r\n        let cardL = strL + bw + (i - 5) * cw + (i - 5) * info.sp\r\n        let cardT = strT + info.sp\r\n        ctx.strokeRect(cardL, cardT, cw, cw)\r\n        if (cards[i] === undefined) continue\r\n        ctx.fillStyle = ColorInfo.cardText\r\n        ctx.font = '28px YaHei'\r\n        ctx.textAlign = 'start'\r\n        ctx.fillText(cards[i].name, cardL+14, cardT+36)\r\n        for (let j in cards[i].cat) {\r\n          ctx.fillText(ClassInfo[cards[i].cat[j]].name, cardL+14, cardT+120+j*40)\r\n        }\r\n      }\r\n      // first button\r\n      ctx.textBaseline=\"top\"\r\n      ctx.fillStyle = ColorInfo.gold\r\n      ctx.fillText(this.game.gold, strL+sp, strT+sp)\r\n      // second redeal button\r\n      ctx.textAlign = 'end'\r\n      ctx.fillStyle = ColorInfo.reDealButton\r\n      ctx.fillRect(strL+sp, strT+sp*2+bth, cw, bth)\r\n      ctx.fillStyle = 'white'\r\n      ctx.fillText(this.game.costRedeal, strL+sp+cw-50, strT+sp*2+bth+40)\r\n      //third upgrade button\r\n      ctx.fillStyle = ColorInfo.upgradeButton\r\n      ctx.fillRect(strL+sp, strT+sp*3+bth*2, cw, bth)\r\n      ctx.fillStyle = 'white'\r\n      ctx.fillText('level'+this.game.lvl, strL+sp+cw-50, strT+sp*3+bth*2+10)\r\n      ctx.fillText(this.game.costUpgrade, strL+sp+cw-50, strT+sp*3+bth*2+40)\r\n    },\r\n    drawHold () {\r\n      if (this.hold !== undefined) {\r\n        let ctx = this.ctx\r\n        let img = new Image()\r\n        img.src = this.hold.src\r\n        let w = PosInfo.hand.w1\r\n        let wEquip = PosInfo.hand.wEquip\r\n        let l = this.mouse.x-w/2\r\n        let t = this.mouse.y-w/2\r\n        ctx.drawImage(img, l, t, w, w)\r\n        if (this.hold instanceof chess) {\r\n          for (let j in this.hold.equips) {\r\n            let img = new Image()\r\n            img.src = this.hold.equips[j].src\r\n            ctx.drawImage(img, l+wEquip*j, t+w-wEquip, wEquip, wEquip)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    drawDamageRecord () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.record\r\n      let record = this.game.damageRecord\r\n      ctx.fillStyle = 'green'\r\n      for (let i in record) {\r\n        ctx.textAlign = 'right'\r\n        ctx.fillText(ChessInfo[record[i].id].name, info.l, info.t+i*info.sph)\r\n        ctx.textAlign = 'left'\r\n        ctx.fillText(record[i].val, info.l+info.spw, info.t+i*info.sph)\r\n      }\r\n    },\r\n    drawclasses () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.class\r\n      let classes = this.game.classes\r\n      let i = 0\r\n      for (let c in classes) {\r\n        ctx.fillStyle = '#333333'\r\n        ctx.textAlign = 'right'\r\n        ctx.fillText(ClassInfo[c].name, info.l, info.t+info.sph*i)\r\n        ctx.textAlign = 'right'\r\n        ctx.fillText(classes[c].n, info.l+info.spw, info.t+info.sph*i)\r\n        ctx.textAlign = 'left'\r\n        for (let s in ClassInfo[c].stage) {\r\n          if (classes[c].active && classes[c].active=== s) {\r\n              ctx.fillStyle = '#333333'\r\n          } else {\r\n            ctx.fillStyle = '#999999'\r\n          }\r\n          ctx.fillText(ClassInfo[c].stage[s], info.l+2*info.spw+25*(s), info.t+info.sph*i)\r\n        }\r\n        i++\r\n      }\r\n    },\r\n    drawEquips () {\r\n      let ctx = this.ctx\r\n      let equips = this.equips\r\n      let info = PosInfo.equips\r\n      for (let i in equips) {\r\n        ctx.strokeStyle = '#999999'\r\n        ctx.strokeRect(info.l, info.t+info.h*i, info.h, info.h)\r\n        if (equips[i]) {\r\n          let img = new Image()\r\n          img.src = equips[i].src\r\n          ctx.drawImage(img, info.l, info.t+info.h*i, info.h, info.h)\r\n        }\r\n      }\r\n    },\r\n    drawSchedule () {\r\n      let ctx = this.ctx\r\n      let sch = this.game.schedule\r\n      let info = PosInfo.schedule\r\n      if (sch.status === 'prepare' || sch.status === 'battle' && sch.p >= sch.pn) {\r\n        ctx.lineWidth = 5\r\n        ctx.beginPath()\r\n        if (sch.p <= sch.pn) {\r\n          ctx.strokeStyle = '#555'\r\n          ctx.arc(this.w/2, info.t, info.arcR, Math.PI/2-(1-sch.p/sch.pn)*Math.PI*2, Math.PI/2)\r\n        } else {\r\n          let opacity = (40-Math.abs(((sch.p-sch.pn)%80)-40))*0.02\r\n          ctx.strokeStyle = `rgba(85, 85, 85, ${opacity})`\r\n          ctx.arc(this.w/2, info.t, info.arcR, -Math.PI*3/2, Math.PI/2)\r\n        }\r\n        ctx.stroke()\r\n        ctx.lineWidth = 1\r\n      }\r\n      ctx.fillText(this.entry.room.stage, this.w/2, info.t)\r\n    },\r\n    drawPlayers () {\r\n      let ctx = this.ctx\r\n      let info = PosInfo.player\r\n      for (let i in this.entry.room.users) {\r\n        let user = this.entry.room.users[i]\r\n        ctx.fillText(user.name, this.w/2+info.l, info.t+info.sph*i)\r\n        ctx.fillText(user.hp, this.w/2+info.l+info.spw, info.t+info.sph*i)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\nhtml {\r\n  height: 100%;\r\n}\r\nbody {\r\n  margin: 0;\r\n  height: 100%;\r\n}\r\n#app {\r\n  position: relative;\r\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  height: 100%;\r\n  text-align: center;\r\n  color: #2c3e50;\r\n}\r\nbutton {\r\n  outline: none;\r\n  background-color: #EEE;\r\n  border: none;\r\n  padding: .5rem;\r\n  cursor: pointer;\r\n}\r\ninput {\r\n  outline: none;\r\n  padding: .5rem;\r\n  border: #ccc 1px solid;\r\n}\r\n.entry {\r\n  height: 100%;\r\n  text-align: left;\r\n  .block {\r\n    padding-top: 3rem;\r\n    text-align: center;\r\n    button {\r\n      padding: 1rem 2rem;\r\n      margin: 1rem 1rem;\r\n      transition: .2s ease-in-out;\r\n      &:hover {\r\n        background-color: #ddd;\r\n      }\r\n    }\r\n  }\r\n  .block-list {\r\n    padding: 2rem 2rem;\r\n    text-align: left;\r\n    div {\r\n      padding: 2rem;\r\n      border-top: 1px solid #ddd;\r\n      cursor: pointer;\r\n      &:hover {\r\n        background-color: #fafafa;\r\n      }\r\n      span {\r\n        margin-right: 2rem;\r\n      }\r\n      .span-right {\r\n        float: right;\r\n      }\r\n    }\r\n    .disable {\r\n      background-color: #eee;\r\n    }\r\n  }\r\n}\r\n.game {\r\n  height: 100%;\r\n  // opacity: 0;\r\n  // &:hover {\r\n  //   opacity: 1;\r\n  // }\r\n}\r\n.show {\r\n  position: fixed;\r\n  padding: 5px;\r\n  width: 10rem;\r\n  height: 6rem;\r\n  font-size: 0.75rem;\r\n  color: #4d373a;\r\n  background-color: #d3cdbf;\r\n}\r\n.attr {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  text-align: left;\r\n  div {\r\n    flex: 0 0 auto;\r\n    width: 25%;\r\n  }\r\n}\r\n.buff {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  text-align: left;\r\n  font-size: .25rem;\r\n  div {\r\n    flex: 0 0 auto;\r\n    width: 25%;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4093fbd4&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport App from './App.vue'\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  render: h => h(App),\r\n}).$mount('#app')\r\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}