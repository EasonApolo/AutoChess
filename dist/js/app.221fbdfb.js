(function(t){function s(s){for(var i,n,o=s[0],h=s[1],c=s[2],l=0,d=[];l<o.length;l++)n=o[l],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&d.push(a[n][0]),a[n]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(t[i]=h[i]);u&&u(s);while(d.length)d.shift()();return r.push.apply(r,c||[]),e()}function e(){for(var t,s=0;s<r.length;s++){for(var e=r[s],i=!0,o=1;o<e.length;o++){var h=e[o];0!==a[h]&&(i=!1)}i&&(r.splice(s--,1),t=n(n.s=e[0]))}return t}var i={},a={app:0},r=[];function n(s){if(i[s])return i[s].exports;var e=i[s]={i:s,l:!1,exports:{}};return t[s].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=t,n.c=i,n.d=function(t,s,e){n.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,s){if(1&s&&(t=n(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var i in t)n.d(e,i,function(s){return t[s]}.bind(null,i));return e},n.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(s,"a",s),s},n.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},n.p="/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],h=o.push.bind(o);o.push=s,o=o.slice();for(var c=0;c<o.length;c++)s(o[c]);var u=h;r.push([0,"chunk-vendors"]),e()})({0:function(t,s,e){t.exports=e("56d7")},"56d7":function(t,s,e){"use strict";e.r(s);e("cadf"),e("551c"),e("f751"),e("097d");var i=e("2b0e"),a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app"}},[t.entry.inentry?e("div",{staticClass:"entry"},[t.entry.login?t._e():e("div",{staticClass:"block"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.entry.name,expression:"entry.name"}],attrs:{placeholder:"name"},domProps:{value:t.entry.name},on:{input:function(s){s.target.composing||t.$set(t.entry,"name",s.target.value)}}}),e("br"),e("input",{directives:[{name:"model",rawName:"v-model",value:t.entry.password,expression:"entry.password"}],attrs:{placeholder:"password"},domProps:{value:t.entry.password},on:{input:function(s){s.target.composing||t.$set(t.entry,"password",s.target.value)}}}),e("br"),t.entry.error?e("div",[t._v(t._s(t.entry.error))]):t._e(),e("button",{on:{click:t.login}},[t._v("登录")]),e("button",{on:{click:t.signup}},[t._v("注册")])]),t.entry.login&&!t.entry.inroom?e("div",{staticClass:"block"},[t._v("\n      "+t._s(t.entry.name)+"\n      "),e("button",{directives:[{name:"show",rawName:"v-show",value:t.entry.name,expression:"entry.name"}],on:{click:t.createRoom}},[t._v("创建房间")]),t.entry.error?e("div",[t._v(t._s(t.entry.error))]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.entry.name,expression:"entry.name"}],staticClass:"block-list"},[t._v("\n      房间列表：\n        "),t._l(t.entry.rooms,function(s){return e("div",{key:s.id,class:{disable:s.users.length>=2},on:{click:function(e){return t.joinRoom(s.id)}}},[e("span",[t._v(t._s(s.users[0].name))]),s.users[1]?e("span",[t._v(t._s(s.users[1].name))]):t._e(),s.start?t._e():e("span",{staticClass:"span-right"},[t._v(t._s(s.users.length)+"/2 准备中")]),s.start?e("span",{staticClass:"span-right"},[t._v("第"+t._s(s.stage)+"回合")]):t._e()])})],2)]):t._e(),t.entry.inroom?e("div",{staticClass:"block"},[t._v("\n      "+t._s(t.entry.name)+"\n      "),e("div",[t._v("房间中")]),t.entry.error?e("div",[t._v(t._s(t.entry.error))]):t._e(),e("div",{staticClass:"block-list"},[t._v("\n        玩家列表：\n        "),t._l(t.entry.room.users,function(s){return e("div",{key:s.id},[t._v(t._s(s.name))])})],2),e("button",{attrs:{disabled:t.entry.room.users.length<2},on:{click:t.startRoom}},[t._v("开始")]),e("button",{on:{click:t.exitRoom}},[t._v("退出")])]):t._e()]):t._e(),t.entry.inentry?t._e():e("div",{staticClass:"game"},[e("canvas",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"canvas",width:t.w,height:t.h},on:{click:t.click,mousemove:t.mousemove}}),t._l(t.allsrc,function(t){return e("div",{key:t,staticStyle:{display:"none"}},[e("img",{attrs:{src:t}})])}),void 0!==t.showChess?e("div",{staticClass:"show",style:{left:t.showPos[0],top:t.showPos[1]}},[t._v("\n      "+t._s(t.showChess.name)+"\n      "),e("div",{staticClass:"attr"},[e("div",[t._v("ad:")]),e("div",[t._v(t._s(t.showChess.ad.toFixed(0)))]),e("div",[t._v("as:")]),e("div",[t._v(t._s(t.showChess.as.toFixed(2)))]),e("div",[t._v("range:")]),e("div",[t._v(t._s(t.showChess.range.toFixed(0)))]),e("div",[t._v("armor:")]),e("div",[t._v(t._s(t.showChess.armor.toFixed(0)))]),e("div",[t._v("mr:")]),e("div",[t._v(t._s(t.showChess.mr.toFixed(0)))])]),e("div",{staticClass:"buff"},t._l(t.showChess.buff,function(s,i){return e("div",{key:i},[t._v("\n          "+t._s(s.name)+"\n        ")])}),0)]):t._e()],2)])},r=[],n=(e("7514"),e("75fc")),o=e("768b"),h=(e("6b54"),e("7f7f"),e("20d6"),e("55dd"),e("6c7b"),[{id:0,name:"麦林炮手",cost:1,cat:[0,1]},{id:1,name:"圣枪游侠",cost:2,cat:[0,2]},{id:2,name:"疾风剑豪",cost:5,cat:[3,4]},{id:3,name:"法外狂徒",cost:1,cat:[0,5]}]),c=(e("6762"),e("2fdb"),e("013f")),u=e("b0b4"),l=e("308d"),d=e("6bb5"),p=e("4e2b"),f=e("d225");e("c5f6");function v(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*t)+s}function m(t,s){t.splice(t.indexOf(s),1)}function g(t){return t.map(function(t){return Number(t)})}var b={board:{marTop:200,w:1500,h:1100,w1:110,ratio:Math.sqrt(3)/2,w2:132,wEquip:44,hpW:120,hpT:70,hpH:3,mpT:67,spT:64},hand:{marTop:1310,w:2260,h:260,w1:240,wEquip:44,sp:10},store:{w:1700,h:300,w1:260,sp:20,bh:220/3},record:{l:100,t:100,spw:50,sph:30},class:{l:100,t:500,spw:70,sph:30},equips:{l:100,t:600,h:70},schedule:{t:70,arcR:50},player:{l:800,t:600,spw:100,sph:40}},y=function(){function t(s,e,i){var a;Object(f["a"])(this,t),this.src=e,this.tgt=i,this.vm=s,this.coord=(a=this.vm).getCoord.apply(a,Object(n["a"])(e.pos)),this.status={prepare:!0},this.vm.util.push(this)}return Object(u["a"])(t,[{key:"act",value:function(){var t,s=Object(o["a"])(this.coord,2),e=s[0],i=s[1],a=(t=this.vm).getCoord.apply(t,Object(n["a"])(this.tgt.pos)),r=Object(o["a"])(a,2),h=r[0],c=r[1];e===h&&i===c&&(this.status.ready=!0,this.status.prepare=!1);var u=this.vm.getEuclid(e,i,h,c),l=this.sp/60/u;l>1?(this.coord[0]=h,this.coord[1]=c):(this.coord[0]=e+l*(h-e),this.coord[1]=i+l*(c-i))}},{key:"effect",value:function(){this.vm.damage(this),m(this.vm.util,this)}}]),t}(),w=function(t){function s(t,e,i){var a;return Object(f["a"])(this,s),a=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e,i)),a.damage=e.ad,a.sp=e.util.sp,a.type=0,a}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"draw",value:function(t,s,e){t.fillStyle="blue",t.fillRect(s+this.coord[0]-5,e+this.coord[1]-5,10,10)}}]),s}(y),O=function(t){function s(t,e,i,a){var r;return Object(f["a"])(this,s),r=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e,i)),r.sp=e.util.sp,r.size=e.util.sz,r.damage=a,r.type=1,r}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"draw",value:function(t,s,e){t.fillStyle="white",t.fillRect(s+this.coord[0]-this.size/2,e+this.coord[1]-this.size/2,this.size,this.size),t.strokeStyle="black",t.strokeRect(s+this.coord[0]-this.size/2,e+this.coord[1]-this.size/2,this.size,this.size)}}]),s}(y),j=function(t){function s(t,e,i){var a;return Object(f["a"])(this,s),a=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e,i)),a.sp=e.util.bomb_sp,a.size=e.util.bomb_sz,a.type=1,a}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"draw",value:function(t,s,e){t.fillStyle="red",t.fillRect(s+this.coord[0]-this.size/2,e+this.coord[1]-this.size/2,this.size,this.size),t.strokeStyle="black",t.strokeRect(s+this.coord[0]-this.size/2,e+this.coord[1]-this.size/2,this.size,this.size)}},{key:"effect",value:function(){this.tgt.buff.push(new R(this.vm,this.src,this.tgt)),m(this.vm.util,this)}}]),s}(y),_=function t(s,e){Object(f["a"])(this,t),this.vm=s,this.vm.util.push(this),this.src=e,this.status={prepare:!0}},k=function(t){function s(t,e,i,a){var r;return Object(f["a"])(this,s),r=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),r.base=[150,350,550],r.damage=r.base[r.src.lvl],r.start=i,r.end=a,r.width=10,r.type=1,r.pre=5,r.post=20,r}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"act",value:function(){this.status.prepare?this.pre<=0?this.status={ready:!0}:this.pre--:this.status.done&&(this.post<=0?m(this.vm.util,this):this.post--)}},{key:"effect",value:function(){this.status={done:!0};var t=[(this.start[0]+this.end[0])/2,(this.start[1]+this.end[1])/2],s=this.end,e=this.vm.board.grid;for(var i in e)for(var a in e){var r,o,h;if(void 0!==e[i][a]&&(r=this.vm).getDistance.apply(r,Object(n["a"])(this.src.pos).concat([i,a]))<3&&this.src.camp!==e[i][a].camp)((o=this.vm).getEuclid.apply(o,t.concat(Object(n["a"])(this.vm.getCoord(i,a))))<76||(h=this.vm).getEuclid.apply(h,Object(n["a"])(s).concat(Object(n["a"])(this.vm.getCoord(i,a))))<76)&&this.vm.damage(this,e[i][a])}}},{key:"draw",value:function(t,s,e){var i=this.pre>0?1-this.pre/5:this.post/20;t.lineWidth=5,t.strokeStyle="rgba(222, 222, 222, ".concat(i,")"),t.beginPath();var a=[this.start[0]+s,this.start[1]+e],r=[this.end[0]+s,this.end[1]+e];t.moveTo.apply(t,a),t.lineTo.apply(t,r),t.stroke(),t.lineWidth=1}}]),s}(_),x=function(t){function s(t,e,i,a){var r,o;return Object(f["a"])(this,s),o=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),o.w=0,o.sp=90,o.now=0,o.len=10*b.board.w1,o.start=(r=o.vm).getCoord.apply(r,Object(n["a"])(e.pos)),o.pos=o.start,o.x_len=i,o.y_len=a,o.been=[],o.post=20,o.base=[150,350,550],o.damage=o.base[o.src.lvl],o.stun=90,o.stun_type=0,o}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"act",value:function(){if(this.status.prepare){if(this.now===this.sp)return this.status={done:!0},void(this.post=this.sp/3);var t=this.now/this.sp;this.w=this.now,this.pos=[t*this.x_len+this.start[0],t*this.y_len+this.start[1]];var s=this.vm.board.grid;for(var e in s)for(var i in s[e]){var a;if(void 0!==s[e][i]&&s[e][i].camp!==this.src.camp&&this.been.indexOf(s[e][i])<0)(a=this.vm).getEuclid.apply(a,Object(n["a"])(this.pos).concat(Object(n["a"])(this.vm.getCoord(e,i))))<66+this.w&&(this.vm.damage(this,s[e][i]),s[e][i]&&this.vm.stun(this,s[e][i]),this.been.push(s[e][i]))}this.now++}else this.status.done&&(this.w=3*this.post,this.post<=0&&m(this.vm.util,this),this.post--)}},{key:"draw",value:function(t,s,e){t.strokeStyle="rgb(200,200,200)",t.lineWidth="5",t.beginPath(),t.arc(this.pos[0]+s,this.pos[1]+e,this.w,0,2*Math.PI),t.stroke(),t.lineWidth="1"}}]),s}(_),C=function(t){function s(t,e,i){var a,r;return Object(f["a"])(this,s),r=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),r.w=10,r.sp=10,r.now=0,r.start=(a=r.vm).getCoord.apply(a,Object(n["a"])(e.pos)),r.xys=i,r.pos=i.map(function(t){return r.start}),r.been=[r.src.status.target],r.post=20,r.damage=r.src.ad,r}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"act",value:function(){if(this.status.prepare){if(this.now===this.sp)return void(this.status={done:!0});var t=this.now/this.sp;for(var s in this.xys)this.pos[s]=[this.start[0]+this.xys[s][0]*t,this.start[1]+this.xys[s][1]*t];var e=this.vm.board.grid;for(var i in e)for(var a in e[i])if(void 0!==e[i][a]&&e[i][a].camp!==this.src.camp&&this.been.indexOf(e[i][a])<0)for(var r in this.pos){var o;if((o=this.vm).getEuclid.apply(o,Object(n["a"])(this.pos[r]).concat(Object(n["a"])(this.vm.getCoord(i,a))))<66+this.w){this.vm.damage(this,e[i][a]),this.been.push(e[i][a]);break}}this.now++}else this.status.done&&(this.post<=0&&m(this.vm.util,this),this.post--)}},{key:"draw",value:function(t,s,e){for(var i in t.strokeStyle=this.status.prepare?"#eec545":"rgba(238,197,69,".concat(this.post/20,")"),t.lineWidth="3",this.pos)t.beginPath(),t.moveTo(this.start[0]+s,this.start[1]+e),t.lineTo(this.pos[i][0]+s,this.pos[i][1]+e),t.stroke();t.lineWidth="1"}}]),s}(_),S=e("af87"),q=function t(s,e){Object(f["a"])(this,t),this.vm=s,this.src=e},P=function(t){function s(t,e){return Object(f["a"])(this,s),Object(l["a"])(this,Object(d["a"])(s).call(this,t,e))}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){if(["damage","attack"].includes(t)){if("damage"===t){var s=arguments.length<=1?void 0:arguments[1],e=(arguments.length<=2||arguments[2],.1*s);this.src._mp+=e}else"attack"===t&&(this.src._mp+=v(5,6));this.src._mp>=this.src.mp&&(this.src._mp=this.src.mp)}}}]),s}(q),M=function(t){function s(t,e,i){var a;return Object(f["a"])(this,s),a=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),a.name="圣枪银弹",a.tgt=i,a.base=[100,225,350],a}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){var s=this;"attack"===t&&(Object(S["setTimeout"])(function(){s.tgt&&new O(s.vm,s.src,s.tgt,s.base[s.src.lvl])},300),m(this.src.buff,this))}}]),s}(q),R=function(t){function s(t,e,i){var a;return Object(f["a"])(this,s),a=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),a.name="爆炸火花",a.stage=0,a.tgt=i,a.base=[150,225,300],a.lvl=e.lvl,a.damage=0,a.type=1,Object(S["setTimeout"])(function(){0===a.damage&&a.explode()},4e3),a}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){if("damage"===t){var s=arguments.length<=2?void 0:arguments[2];s.tgt===this.tgt&&s.src===this.src&&(this.stage++,this.stage>=3&&this.explode())}}},{key:"explode",value:function(){m(this.tgt.buff,this),this.damage=(1+.5*this.stage)*this.base[this.lvl];var t=this.vm.getSixPos(this.tgt.pos);for(var s in t){var e=t[s],i=this.vm.board.grid[e[0]][e[1]];void 0!=i&&i.camp!=this.src.camp&&this.vm.damage(this,i)}this.vm.damage(this)}},{key:"draw",value:function(t,s,e){t.fillStyle="red";var i=6*(this.stage+1);t.fillRect(s-i,e-i,2*i,2*i)}}]),s}(q),T=function(t){function s(t,e,i,a){var r,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;return Object(f["a"])(this,s),r=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),r.type=i,r.val=a,r.rate=n,o&&(r.name=o),r}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){if(t===this.type)return[this.val,this.rate]}}]),s}(q),I=function(t){function s(t,e){var i;return Object(f["a"])(this,s),i=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),i.name="大号铅弹",i}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){if(["attack"].includes(t)){var s,e,i=2*(this.src.range+1)*b.board.w1*b.board.ratio,a=(s=this.vm).getCoord.apply(s,Object(n["a"])(this.src.status.target.pos)),r=Object(o["a"])(a,2),h=r[0],c=r[1],u=(e=this.vm).getCoord.apply(e,Object(n["a"])(this.src.pos)),l=Object(o["a"])(u,2),d=l[0],p=l[1],f=Math.atan((c-p)/(h-d));h<d&&(f=Math.PI+f);for(var v=[],m=0;m<6;m++)v.push(f+(m-2.5)*Math.PI*2/30);v=v.map(function(t){return[i*Math.cos(t),i*Math.sin(t)]}),new C(this.vm,this.src,v)}}}]),s}(q),E=function(t){function s(t,e,i){var a;return Object(f["a"])(this,s),a=Object(l["a"])(this,Object(d["a"])(s).call(this,t,e)),a.base=[1,2,3],a.extra=a.base[i],a.name="枪手",a}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"response",value:function(t){if(["attack"].includes(t)){var s=v(2);if(s){var e=this.vm.board.grid,i=[];for(var a in e)for(var r in e[a]){var o;e[a][r]&&e[a][r].camp!==this.src.camp&&(o=this.vm).getDistance.apply(o,[a,r].concat(Object(n["a"])(this.src.pos)))<this.src.range&&e[a][r]!==this.src.status.tgt&&i.push([a,r])}if(1===this.src.id&&console.log(i),0===i.length)return;if(i.length>this.extra)do{i.splice(v(i.length),1)}while(i.length>this.extra);for(var h in 1===this.src.id&&console.log(i),i)this.vm.createUtilAttack(this.src,e[i[h][0]][i[h][1]])}}}}]),s}(q),z=function(){function t(s){Object(f["a"])(this,t),this.vm=s}return Object(u["a"])(t,[{key:"die",value:function(){var t=this.vm.board.grid;for(var s in t[this.pos[0]][this.pos[1]]=void 0,this.status)this.status[s]=void 0;this.status.dead=!0}},{key:"equip",value:function(t){this.equips.length<3&&(this.equips.push(t),t.equipTo(this))}},{key:"ad",get:function(){var t=1,s=0;for(var e in this.buff){var i=this.buff[e].response("ad");i&&(i[1]?t+=i[0]:s+=i[0])}return(this._ad+s)*t},set:function(t){this._ad=t}},{key:"name",get:function(){return this._name},set:function(t){this._name=t}},{key:"as",get:function(){var t=1;for(var s in this.buff){var e=this.buff[s].response("as");e&&(e[1]?t+=e[0]:console.log("myError：as buff not rate"))}return this._as*t},set:function(t){this._as=t}},{key:"range",get:function(){var t=1;for(var s in this.buff){var e=this.buff[s].response("range");e&&(e[1]?t+=e[0]:console.log("myError：as buff not rate"))}return this._range*t},set:function(t){this._range=t}}]),t}(),B=[function(t){function s(t){var e;return Object(f["a"])(this,s),e=Object(l["a"])(this,Object(d["a"])(s).call(this,t)),e.id=0,e._name="麦林炮手",e.size=.8,e.cat=[0,1],e.src="Tristana_d.png",e.hp=550,e.mp=50,e._ad=50,e._as=.65,e.sp=75,e._range=4,e.armor=20,e.mr=20,e.util={sp:800,bomb_sp:600,bomb_sz:6},e.lvl=0,e.buff=[],e.spell_pre=10,e.spell=function(){this.status.target&&new j(this.vm,this,this.status.target),this.status.spell=void 0,this.status.attack=0},e}return Object(p["a"])(s,t),s}(z),function(t){function s(t){var e;return Object(f["a"])(this,s),e=Object(l["a"])(this,Object(d["a"])(s).call(this,t)),e.id=1,e._name="圣枪游侠",e.size=.8,e.cat=[0,2],e.src="Lucian_d.png",e.hp=550,e.mp=35,e._ad=65,e._as=.65,e.range=3,e.sp=60,e.armor=20,e.mr=20,e.util={sp:1e3,spell_sp:20,sz:10},e.lvl=0,e.buff=[],e.spell_pre=0,e.spell=function(){if(this.status.target){var t=this.vm.board.grid,s=[];for(var e in t)for(var i in t[e]){var a,r;void 0===t[e][i]&&(a=this.vm).getDistance.apply(a,[e,i].concat(Object(n["a"])(this.pos)))<=2&&(r=this.vm).getDistance.apply(r,[e,i].concat(Object(n["a"])(this.status.target.pos)))<=this.range&&s.push([e,i])}s.length&&(this.status.attack=void 0,this.status.spell=void 0,this.status.jump={p:0,pn:this.util.spell_sp,src:this.pos,tgt:s[v(s.length)]},this.buff.push(new M(this.vm,this,this.status.target)))}},e}return Object(p["a"])(s,t),s}(z),function(t){function s(t){var e;return Object(f["a"])(this,s),e=Object(l["a"])(this,Object(d["a"])(s).call(this,t)),e.id=2,e._name="疾风剑豪",e.lvl=0,e.size=.8,e.cat=[3,4],e.src="Yasuo_d.png",e.hp=700,e.mp=25,e._ad=75,e._as=1,e.range=1,e.sp=60,e.armor=35,e.mr=20,e.util={sp:1e3},e.buff=[],e.spell_pre=30,e.spell_stage=0,e.spell=function(){if(this.status.target){var t,s,e=(t=this.vm).getCoord.apply(t,Object(n["a"])(this.pos)),i=Object(o["a"])(e,2),a=i[0],r=i[1],h=(s=this.vm).getCoord.apply(s,Object(n["a"])(this.status.target.pos)),c=Object(o["a"])(h,2),u=c[0],l=c[1],d=this.vm.getEuclid(a,r,u,l),p=b.board;if(this.spell_stage<2){var f=p.w1*p.ratio*4,v=f/d*(u-a)+a,m=f/d*(l-r)+r;new k(this.vm,this,[a,r],[v,m]),this.spell_stage++}else{var g=p.w1*p.ratio*10,y=(u-a)/d*g,w=(l-r)/d*g;new x(this.vm,this,y,w),this.spell_stage=0}this.status.spell=void 0,this.status.attack=0}},e}return Object(p["a"])(s,t),s}(z),function(t){function s(t){var e;return Object(f["a"])(this,s),e=Object(l["a"])(this,Object(d["a"])(s).call(this,t)),e.id=3,e._name="法外狂徒",e.lvl=0,e.size=.8,e.cat=[0,5],e.src="Graves_d.png",e.hp=450,e.mp=0,e._ad=55,e._as=.55,e.range=1,e.sp=60,e.armor=30,e.mr=20,e.util={sp:1e3},e.buff=[new I(e.vm,Object(c["a"])(e))],e}return Object(p["a"])(s,t),s}(z)],A=[{name:"枪手",stage:[2,4,6],buff:D},{name:"约德尔人",stage:[3,6]},{name:"贵族",stage:[3,6]},{name:"剑士",stage:[3,6,9]},{name:"浪人",stage:[1],exact:0},{name:"海盗",stage:[3]},{name:"恶魔",stage:[2,4,6]}];function D(t,s,e){var i=t.board.grid;for(var a in i)for(var r in i)i[a][r]&&i[a][r].camp===s&&i[a][r].cat.includes(0)&&i[a][r].buff.push(new E(t,i[a][r],e))}var W={section:"rgb(250, 250, 250)",obj:"rgb(100, 100, 100)",cardText:"rgb(66, 66, 66)",reDealButton:"rgb(199, 99, 99)",upgradeButton:"rgb(99, 99, 199)",gold:"#ffd700",chessHpBorder:"rgb(66,66,66)",chessHp:"#be8c19",chessHpOppo:"red",chessMp:"blue",chessSp:"#ccc"},U=(e("5118"),function t(s){Object(f["a"])(this,t),this.vm=s,this.chess=void 0}),H=[function(t){function s(t){var e;return Object(f["a"])(this,s),e=Object(l["a"])(this,Object(d["a"])(s).call(this,t)),e.src="rapid_fire_cannon.png",e.id=0,e.name="疾射火炮",e}return Object(p["a"])(s,t),Object(u["a"])(s,[{key:"equipTo",value:function(t){this.chess=t;var s=new T(this.vm,this.chess,"as",.4,1,"攻速_疾射火炮"),e=new T(this.vm,this.chess,"range",1,1,"射程_疾射火炮");this.chess.buff=this.chess.buff.concat([s,e])}}]),s}(U)],N=[2,2,6,10,18,30,46,70],G={name:"app",data:function(){return{entry:{inentry:!0,error:void 0,name:"",password:"",login:!1,rooms:void 0,inroom:!1,room:void 0},fetchID:void 0,canvas:void 0,ctx:void 0,w:0,h:0,mouse:{x:void 0,y:void 0},game:{turn:0,gold:100,exp:0,lvl:1,costUpgrade:4,costRedeal:2,damageRecord:[],grave:[],classes:{},schedule:{},hp:100,enemy:void 0,clickBoard:!0,combo:0},hold:void 0,board:{grid:void 0},store:{cards:new Array(5).fill(void 0)},hand:{cards:new Array(9).fill(void 0)},equips:new Array(9).fill(void 0),allsrc:[],queue:[],util:[],showChess:void 0,showPos:void 0,ip:"http://47.106.171.107:80/"}},created:function(){var t=this;addEventListener("mousemove",function(s){t.mouse.x=2*s.clientX,t.mouse.y=2*s.clientY}),this.initBoard()},mounted:function(){this.fetchID=setInterval(this.fetchStatus,3e3)},computed:{sortedRoomUsers:function(){var t=this.entry.room.users;return t.sort(function(t,s){return t.hp-s.hp})}},methods:{getUserIndex:function(t){return this.entry.room.users.findIndex(function(s){return s.name===t})},getEnemyIndex:function(){return this.getUserIndex(this.game.enemy.name)},getMeIndex:function(){return this.getUserIndex(this.entry.name)},dealError:function(t){console.log(t)},fetch:function(t){function s(s,e){return t.apply(this,arguments)}return s.toString=function(){return t.toString()},s}(function(t,s){var e=this,i=new FormData;for(var a in s)i.append(a,s[a]);return new Promise(function(s,a){fetch(e.ip+t,{body:i,method:"POST"}).then(function(t){return t.json()}).then(function(t){t.error?(e.dealError(t),a()):s(t)})})}),login:function(){var t=this,s={name:this.entry.name,password:this.entry.password};this.fetch("user/login",s).then(function(s){t.entry.login=!0,void 0!==s.start&&(t.entry.inroom=!0,t.entry.room=s)})},signup:function(){var t=this,s={name:this.entry.name,password:this.entry.password};this.fetch("user/signup",s).then(function(s){t.entry.login=!0})},fetchStatus:function(){this.entry.login&&(this.entry.inroom?this.entry.inroom&&this.fetchRoom():this.fetchRooms())},fetchRooms:function(){var t=this;fetch(this.ip+"room/list").then(function(t){return t.json()}).then(function(s){t.entry.rooms=s})},fetchRoom:function(){var t=this,s={roomid:this.entry.room.id};this.fetch("room",s).then(function(s){t.entry.room=s,s.start&&(t.entry.inentry=!1,clearInterval(t.fetchID),t.$nextTick(t.startGame))})},joinRoom:function(t){var s=this,e={name:this.entry.name,roomid:t};this.fetch("room/join",e).then(function(t){s.entry.inroom=!0,s.entry.room=t})},exitRoom:function(){var t=this,s={name:this.entry.name,roomid:this.entry.room.id};this.fetch("room/exit",s).then(function(s){t.entry.inroom=!1,t.entry.rooms=s})},createRoom:function(){var t=this,s={name:this.entry.name};this.fetch("room/create",s).then(function(s){t.entry.inroom=!0,t.entry.room=s})},startRoom:function(){var t={roomid:this.entry.room.id};this.fetch("room/start",t)},fetchGameStatus:function(){var t=this,s={roomid:this.entry.room.id};this.fetch("room",s).then(function(s){t.entry.room=s;var e=t.entry.room;(e.start=!1)&&(t.entry.inentry=!0)})},startGame:function(){this.w=2*document.documentElement.clientWidth,this.h=2*document.documentElement.clientHeight,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.deal(),this.main(),this.equips[0]=new H[0],this.equips[1]=new H[0],this.equips[2]=new H[0],this.queue.push(this.actAll)},main:function(){for(var t in this.clearAll(),this.drawBoard(),this.drawHand(),this.drawStore(),this.drawHold(),this.drawUtil(),this.drawDamageRecord(),this.drawclasses(),this.drawEquips(),this.drawSchedule(),this.drawPlayers(),this.queue)this.queue[t]();this.schedule(),window.requestAnimationFrame(this.main)},schedule:function(){var t=this,s=this.game.schedule,e=this.board.grid;if("prepare"===s.status){if(0===s.p)this.fetchGameStatus(),this.updateGold(),this.updateExp();else if(s.p<s.pn);else if(s.p===s.pn){this.game.clickBoard=!1;var i={grids:[],hand:[],equip:[]};for(var a in e)for(var r in e)if(void 0!==e[a][r]){var n={pos:[a,r],id:e[a][r].id,lvl:e[a][r].lvl};if(e[a][r].equips)for(var o in n.equip=[],e[a][r].equips)n.equip.push(e[a][r].equips[o].id);i.grids.push(n)}for(var h in this.hand.cards)void 0!==this.hand[h]&&i.hand.push(this.hand[h].id);for(var c in this.equips)void 0!==this.equips[c]&&i.equip.push(this.equips[c].id);var u={roomid:this.entry.room.id,name:this.entry.name,data:JSON.stringify(i)};this.fetch("data/start",u).then(function(s){t.setChessByData(JSON.parse(s.data),1),t.game.enemy=s,t.game.schedule={status:"battle",p:0,pn:1e5},t.startRound()})}else s.p,s.pn;s.p++}else if("battle"===s.status){if(s.p==s.pn){var l={roomid:this.entry.room.id,name:this.entry.name,hp:this.game.hp};this.fetch("data/end",l).then(function(s){console.log(s),t.initBoard(),t.setChessByData(JSON.parse(s.data),0),t.game.schedule={status:"prepare",p:0,pn:300},t.game.clickBoard=!0})}else s.p;s.p++}else this.game.schedule={status:"prepare",p:0,pn:300}},initBoard:function(){var t=new Array(6).fill(void 0);this.board.grid=t.map(function(t){return new Array(7).fill(void 0)})},mousemove:function(t){if(this.hold)return this.showChess=void 0,void(this.showPos=void 0);var s=2*t.clientX,e=2*t.clientY,i=this.getPosByCoord(s,e);if(i){var a=Object(o["a"])(i,2),r=a[0],n=a[1];if(this.board.grid[r][n])return this.showChess=this.board.grid[r][n],void(this.showPos=[s/2+1+"px",e/2+1+"px"])}this.showChess=void 0,this.showPos=void 0},click:function(t){var s=2*t.clientX,e=2*t.clientY,i=this.getPosByCoord(s,e);if(this.game.clickBoard&&i){var a=Object(o["a"])(i,2),r=a[0],n=a[1];this.hold instanceof U?this.board.grid[r][n]&&this.equiping(this.board.grid[r][n]):this.setChess(r,n)}var h=b.hand;if(s>this.w/2-h.w/2&&s<this.w/2+h.w/2&&e>h.marTop&&e<h.marTop+h.h){if((s-(this.w/2-h.w/2))%(h.sp+h.w1)<h.sp||(e-h.marTop)%(h.w1+h.sp)<h.sp)return;var c=Math.floor((s-(this.w/2-h.w/2))/(h.sp+h.w1));if(this.hold instanceof U)this.hand.cards[c]&&this.equiping(this.hand.cards[c]);else{var u=this.hand.cards,l=this.hold;this.hold=u[c],u[c]=l}}if(h=b.store,s>this.w/2-h.w/2&&s<this.w/2+h.w/2&&e>this.h-h.h&&e<this.h){var d=s-(this.w/2-h.w/2),p=e-(this.h-h.h);if(d%(h.w1+h.sp)<h.sp||p%(h.w1+h.sp)<h.sp)return;if(d<h.w1+h.sp){if(p%(h.bh+h.sp)<h.sp)return;1==Math.floor(p/(h.bh+h.sp))?this.buyDeal():2==Math.floor(p/(h.bh+h.sp))&&this.buyUpgrade()}else{var f=Math.floor(d/(h.w1+h.sp))-1;this.buyCard(f)}}if(h=b.equips,s>h.l&&s<h.l+h.h&&e>h.t&&e<h.t+h.h*this.equips.length){var v=Math.floor((e-h.t)/h.h);if(!this.hold||this.hold instanceof U){var m=this.hold;this.hold=this.equips[v],this.equips[v]=m}}},deal:function(){for(var t=0;t<5;t++){var s=Math.floor(Math.random()*h.length);this.store.cards[t]=h[s]}},addExp:function(t){if(this.game.lvl>=9)return!1;var s=N[this.game.lvl-1];return this.game.exp=this.game.exp+this.game.costUpgrade,this.game.exp>=s&&(this.game.exp=8==this.game.lvl?0:this.game.exp-s,this.game.lvl++),!0},buyDeal:function(){console.log("bb"),this.game.gold>=this.game.costRedeal&&(this.game.gold-=this.game.costRedeal,this.deal())},buyUpgrade:function(){this.game.gold>=this.game.costUpgrade&&this.addExp(this.game.costUpgrade)&&(this.game.gold-=this.game.costUpgrade)},buyCard:function(t){var s=this.store.cards[t];this.game.gold>=s.cost&&(this.store.cards[t]=void 0,this.game.gold-=s.cost,this.addChess(s.id))},updateGold:function(){var t=5;this.entry.room.stage<2?t=2:this.entry.room.stage<4&&(t=parseInt(this.entry.room.stage));var s=Math.min(Math.floor(this.game.gold/10),5),e=Math.min(Math.floor(this.game.combo/2),3);this.game.gold+=t+s+e},updateExp:function(){this.addExp(2)},startRound:function(){this.queue.push(this.checkRemain),this.initAllChess()},actAll:function(){var t=this.board.grid;for(var s in t)for(var e in t[s])if(void 0!==t[s][e]){var i=t[s][e];if(i.status.ready){var a=this.findNearestOppo(i,s,e),r=a[0],o=a[1];void 0!==r&&(o<=i.range?(i.status.ready=void 0,i.status.attack=0,i.status.target=t[r[0]][r[1]]):this.moveChess(i,r)&&(i.status.ready=void 0,i.status.move=0))}else if(i.status.attack>=0)if(void 0!==i.status.target&&i.status.target.status.dead)i.status.ready=!0,i.status.attack=void 0,i.status.target=void 0;else if(this.getDistance.apply(this,Object(n["a"])(i.pos).concat(Object(n["a"])(i.status.target.pos)))>i.range)this.moveChess(i,i.status.target.pos)&&(i.status.move=0),i.status.attack=void 0,i.status.target=void 0;else{var h=1/i.as*1e3;i.status.attack+=16,i.status.attack>=h&&(i.status.attack=0,this.dealBuff("attack",i),this.createUtilAttack(i,i.status.target),i._mp>=i.mp&&this.castSpell(i))}else if(i.status.move>=0)i.status.move++,i.status.move>=i.sp&&(i.status.move=void 0,i.status.ready=!0);else if(i.status.jump){var c=i.status.jump;0===c.p?(void 0===t[c.tgt[0]][c.tgt[1]]&&(t[i.pos[0]][i.pos[1]]=void 0,t[c.tgt[0]][c.tgt[1]]=i,i.pos=c.tgt),c.p++):c.p>=c.pn?(i.status.jump=void 0,i.status.target&&(i.status.attack=0)):c.p++}else if(i.status.spell>=0)i.status.spell<i.spell_pre?i.status.spell++:(i.status.spell=void 0,i.spell());else if(i.status.stun){var u=i.status.stun;u.p<u.pn?u.p++:(i.status.stun=void 0,i.status.ready=!0)}}var l=this.util;for(var d in l)l[d].status.prepare||l[d].status.done?l[d].act():l[d].status.ready&&l[d].effect()},equiping:function(t){t&&this.hold instanceof U&&(t.equip(this.hold),this.hold=void 0)},moveChess:function(t,s){var e=this.getPath(t,s);if(void 0===e)return!1;var i=e[0],a=this.board.grid;return void 0===a[i[0]][i[1]]&&(t.orient=this.getOrient.apply(this,Object(n["a"])(t.pos).concat(Object(n["a"])(i))),a[t.pos[0]][t.pos[1]]=void 0,a[i[0]][i[1]]=t,t.pos=i,t.status.move=!0),!0},castSpell:function(t){t.spell&&(t.status.attack=void 0,t.status.spell=0,t._mp=0)},damage:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;s||(s=t.tgt);var e=t.damage;0===t.type?e=this.mitigate(s.armor)*e:1===t.type&&(e=this.mitigate(s.mr)*e);var i=this.game.damageRecord;if(0===t.src.camp){var a=Math.round(e),r=i.find(function(s){return s.id===t.src.id});r?r.val+=a:i.push({id:t.src.id,val:a}),i.sort(function(t,s){t.val,s.val})}s._hp-=e,this.dealBuff("damage",s,t.damage,t),s._hp<=0&&s.die()},stun:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;s||(s=t.target),s.status.attack=void 0,s.status.spell=void 0,s.status.ready=void 0,s.status.stun={type:t.stun_type,p:0,pn:t.stun}},mitigate:function(t){return 100/(t+100)},dealBuff:function(t){for(var s=arguments.length,e=new Array(s>1?s-1:0),i=1;i<s;i++)e[i-1]=arguments[i];if("damage"===t){var a=e[0],r=e[1],n=e[2];for(var o in a.buff)a.buff[o].response(t,r,n)}else if("attack"===t){var h=e[0];for(var c in h.buff)h.buff[c].response(t)}},checkRemain:function(){var t=this.board.grid,s=0,e=0;for(var i in t)for(var a in t[i])void 0!==t[i][a]&&(0===t[i][a].camp?s++:1===t[i][a].camp&&e++);if(!(s>0&&e>0)){m(this.queue,this.checkRemain);var r=0;0===s?(r=2*e,this.game.hp-r<0?this.hp=0:this.game.hp-=r,this.game.combo=this.game.combo>=0?-1:this.game.combo-1):0===e&&(this.game.combo=this.game.combo<=0?1:this.game.combo+1),"battle"===this.game.schedule.status&&(this.game.schedule.p=this.game.schedule.pn)}},initAllChess:function(){var t=this.board.grid;for(var s in t)for(var e in t[s]){var i=t[s][e];void 0!==i&&(i.status.ready=!0,i.orient=0,i._hp=i.hp,i.mp&&(i._mp=0,console.log(i.buff),i.buff.push(new P(this,i))))}this.game.classes=this.updateClasses(0),this.game.oppoClasses=this.updateClasses(1),this.initClassBuffs(0),this.initClassBuffs(1)},updateClasses:function(t){var s=this.board.grid,e={},i=A,a=[];for(var r in s)for(var n in s)void 0!==s[r][n]&&s[r][n].camp===t&&a.indexOf(s[r][n].name)<0&&(a.push(s[r][n].name),s[r][n].cat.map(function(t){t in e?e[t].n++:e[t]={n:1}}));for(var o in e)for(var h in i[o].stage)if(i[o].exact&&i[o].stage[h]===e[o].n)e[o].active=h;else if(!i[o].exact){if(!(i[o].stage[h]<=e[o].n))break;e[o].active=h}return e},initClassBuffs:function(t){var s=0===t?this.game.classes:this.game.oppoClasses;for(var e in s)s[e].active&&A[e].buff&&A[e].buff(this,t,s[e].active)},setChessByData:function(t,s){var e=t.grids;for(var i in e){var a=e[i],r=void 0,n=void 0;if(1===s?(r=5-a.pos[0],n=6-a.pos[1]):(r=a.pos[0],n=a.pos[1]),this.setChess(r,n,this.createChess(a.id,s)),a.equip)for(var o in a.equip)this.board.grid[r][n].equip(new H[a.equip[o]])}},getPosByCoord:function(t,s){var e=b.board;if(t>this.w/2-e.w/2&&t<this.w/2+e.w/2&&s>e.marTop&&s<e.marTop+e.h){var i=t-this.w/2,a=s-(e.h/2+e.marTop),r=e.w1,n=Math.tan(Math.PI/6),o=e.ratio,h=Math.floor((a+n*i)/r)+8,c=Math.floor((a-n*i+r/2)/r)+7,u=Math.floor((i+o/2*r)/(o*r))+7,l=Math.floor((h+c-7+1)/3),d=Math.floor((u-(l%2+.5)+1)/2);if(d<0||d>6||l<0||l>5)return;return[l,d]}},getOrient:function(t,s,e,i){return t===e?s<i?2:5:t%2==1?e<t?s===i?0:1:s===i?4:3:e<t?s===i?1:0:s===i?3:4},getOrientGrid:function(t,s){var e=[],i=t[0]%2;if(s<2?(e[0]=t[0]-1,e[1]=i?t[1]+s:t[1]+s-1):3==s||4==s?(e[0]=t[0]+1,e[1]=i?t[1]+4-s:t[1]+3-s):e=[t[0],2===s?t[1]+1:t[1]-1],!(e[0]<0||e[0]>5||e[1]<0||e[1]>6))return e},samePos:function(t,s){return t[0]===s[0]&&t[1]===s[1]},getPathNode:function(t,s,e,i,a){a&&console.log(t),i.push(t);var r=this.getSixPos(t),o=[];for(var h in r){var c=r[h];if(this.samePos(s,c))return[c];if(void 0===this.board.grid[c[0]][c[1]]){var u=!1;for(var l in i)if(this.samePos(i[l],c)){u=!0;break}u||o.push({pos:c,d:this.getDistance.apply(this,Object(n["a"])(c).concat(Object(n["a"])(s)))})}}if(0!==o.length){o.sort(function(t,s){return t.d-s.d});var d=[],p=-1;for(var f in o){if(o[f].d!==p&&(p=o[f].d,d.length>0))break;var v=this.getPathNode(o[f].pos,s,e,i.slice(),a);v&&(v.unshift(o[f].pos),d.push(v))}if(d.length>0){var m=this.getShortestPath(d);return m}}},getShortestPath:function(t){var s=100,e=-1;for(var i in t)t[i].length<s&&(s=t[i].length,e=i);return t[e]},getPath:function(t,s){var e=g(s),i=[],a=[],r=!!this.samePos(t.pos,[-1,-1]);return this.getPathNode(t.pos,e,i,a,r)},getSixPos:function(t){t=g(t);var s=t[0]%2===1?[[-1,0],[-1,1],[0,1],[1,1],[1,0],[0,-1]]:[[-1,-1],[-1,0],[0,1],[1,0],[1,-1],[0,-1]],e=[];for(var i in s){var a=s[i],r=t[0]+a[0],n=t[1]+a[1];r<0||r>5||n<0||n>6||e.push([r,n])}return e},getCoord:function(t,s){var e=g([t,s]),i=Object(o["a"])(e,2);t=i[0],s=i[1];var a=b.board.w1,r=b.board.ratio*a*2*s+t%2*a,n=3*t/2*a;return[r,n]},getEuclid:function(t,s,e,i){return Math.sqrt(Math.pow(t-e,2)+Math.pow(s-i,2))},getDistance:function(t,s,e,i){var a=g([t,s,e,i]),r=Object(o["a"])(a,4);t=r[0],s=r[1],e=r[2],i=r[3];var n=void 0,h=Math.abs(t-e),c=Math.ceil(h/2),u=void 0,l=void 0,d=void 0;return t%2===e%2?(u=s+c,l=s-c):t%2===1?(u=s+c,l=s-c+1):e%2===1&&(u=s+c-1,l=s-c),i<=u&&i>=l?n=0:i>u?n=i-u:i<l&&(n=l-i),d=n+h,d},findNearestOppo:function(t,s,e){var i=this.board.grid,a=100,r=[],n=void 0;for(var o in i)for(var h in i[o])if(void 0!==i[o][h]&&i[o][h].camp!==t.camp){var c=this.getDistance(s,e,o,h);c<a?(a=c,r=[[o,h]]):c==a&&r.push([o,h])}return n=r.length>1?r[v(r.length)]:r[0],n&&(n=g(n)),[n,a]},setGrid:function(t,s,e){void 0!==e&&(e.pos=[t,s]),this.board.grid[t][s]=e},setChess:function(t,s){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this.board.grid;if(void 0===e){if(t<=2)return;var a=this.hold;this.hold=i[t][s],this.setGrid(t,s,a)}else this.setGrid(t,s,e)},addChess:function(t){var s=this.hand.cards;for(var e in s)if(void 0===s[e]){s[e]=this.createChess(t,0),this.allsrc.indexOf(s[e].src)<0&&this.allsrc.push(s[e].src);break}},createChess:function(t,s){var e=new B[t](this);return e.hold=!1,e.pos=void 0,e.status={},e.camp=s,e.equips=[],e},createUtilAttack:function(t,s){new w(this,t,s)},clearAll:function(){var t=this.ctx;t.clearRect(0,0,this.w,this.h)},drawUtil:function(){var t=this.util,s=this.ctx,e=b.board,i=this.w/2-6.5*e.ratio*e.w1,a=e.marTop+e.h/2-3.75*e.w1;for(var r in t)t[r].draw(s,i,a)},drawBoard:function(){var t=this.ctx,s=b.board,e=this.board.grid,i=s.marTop,a=s.w,r=s.h,h=s.w1,c=s.w2,u=s.ratio;for(var l in t.fillStyle=W.section,t.fillRect(this.w/2-a/2,i,a,r),e){var d=l%2==1?d=u*h/2:-u*h/2,p=r/2+i+1.5*(l-2.5)*h;for(var f in this.board.grid[l]){var v=this.w/2+(f-3)*u*2*h+d;t.beginPath();for(var m=0;m<6;m++){var g=Math.PI*(1/3*m-1/6),y=Math.cos(g)*h,w=Math.sin(g)*h;this.ctx.lineTo(v+y,p+w)}t.closePath(),t.strokeStyle=W.obj,t.stroke();var O=e[l][f];if(void 0!==O){var j=0,_=0;if(O.status.move>=0){var k=(5-O.orient)*Math.PI/3,x=2*u*h*(1-O.status.move/O.sp);j=x*Math.cos(k),_=-x*Math.sin(k)}if(O.status.jump){var C=O.status.jump,S=this.getCoord.apply(this,Object(n["a"])(C.src)),q=Object(o["a"])(S,2),P=q[0],M=q[1],R=this.getCoord.apply(this,Object(n["a"])(C.tgt)),T=Object(o["a"])(R,2),I=T[0],E=T[1];j=-(I-P)*(1-C.p/C.pn),_=-(E-M)*(1-C.p/C.pn)}var z=new Image;z.src=O.src;var B=O.size*c;if(t.drawImage(z,v-B/2+j,p-B/2+_,B,B),t.fillStyle=0===O.camp?W.chessHp:W.chessHpOppo,t.fillRect(v-s.hpW/2+j,p-s.hpT+_,O._hp/O.hp*s.hpW,s.hpH),t.fillStyle=W.chessMp,t.fillRect(v-s.hpW/2+j,p-s.mpT+_,O._mp/O.mp*s.hpW,s.hpH),O.status.spell&&(t.fillStyle=W.chessSp,t.fillRect(v-s.hpW/2+j,p-s.spT+_,O.status.spell/O.spell_pre*s.hpW,s.hpH)),O.status.stun&&0===O.status.stun.type){var A=2*Math.PI*(O.status.stun.p%36)/36;t.strokeStyle="#666",t.lineWidth=4,t.beginPath(),t.arc(v+j,p-50+_,20,A,5*Math.PI/3+A),t.stroke(),t.lineWidth=1}for(var D in O.buff)O.buff[D].draw&&O.buff[D].draw(t,v+j,p+_);for(var U in O.equips){var H=new Image;H.src=O.equips[U].src;var N=s.w2/2*O.size,G=s.wEquip*O.size;t.drawImage(H,v-N+j+G*U,p+N+_,G,G)}}}}},drawHand:function(){var t=this.ctx,s=b.hand,e=s.w1,i=s.sp,a=s.w,r=s.h,n=s.marTop,o=this.w/2-a/2,h=this.hand.cards;for(var c in t.fillStyle=W.section,t.fillRect(o,n,a,r),h){t.strokeStyle=W.obj;var u=this.w/2+(c-4-.5)*e+(c-4)*i,l=n+i;if(t.strokeRect(u,l,e,e),h[c]){var d=new Image;for(var p in d.src=h[c].src,t.drawImage(d,u,l,e,e),h[c].equips){var f=new Image;f.src=h[c].equips[p].src,t.drawImage(f,u+s.wEquip*p,l+e-s.wEquip,s.wEquip,s.wEquip)}}}},drawStore:function(){var t=this.ctx,s=b.store,e=s.w,i=s.h,a=s.w1,r=s.sp,n=s.bh,o=this.w/2-e/2,h=this.h-i;t.fillStyle=W.section,t.fillRect(o,h,e,i);var c=this.store.cards;for(var u in c){t.strokeStyle=W.obj;var l=o+e+(u-5)*a+(u-5)*s.sp,d=h+s.sp;if(t.strokeRect(l,d,a,a),void 0!==c[u])for(var p in t.fillStyle=W.cardText,t.font="28px YaHei",t.textAlign="start",t.fillText(c[u].name,l+14,d+36),c[u].cat)t.fillText(A[c[u].cat[p]].name,l+14,d+120+40*p)}t.textBaseline="top",t.fillStyle=W.gold,t.fillText(this.game.gold,o+r,h+r),t.textAlign="end",t.fillStyle=W.reDealButton,t.fillRect(o+r,h+2*r+n,a,n),t.fillStyle="white",t.fillText(this.game.costRedeal,o+r+a-50,h+2*r+n+40),t.fillStyle=W.upgradeButton,t.fillRect(o+r,h+3*r+2*n,a,n),t.fillStyle="white",t.fillText("level"+this.game.lvl,o+r+a-50,h+3*r+2*n+10),t.fillText(this.game.costUpgrade,o+r+a-50,h+3*r+2*n+40)},drawHold:function(){if(void 0!==this.hold){var t=this.ctx,s=new Image;s.src=this.hold.src;var e=b.hand.w1,i=b.hand.wEquip,a=this.mouse.x-e/2,r=this.mouse.y-e/2;if(t.drawImage(s,a,r,e,e),this.hold instanceof z)for(var n in this.hold.equips){var o=new Image;o.src=this.hold.equips[n].src,t.drawImage(o,a+i*n,r+e-i,i,i)}}},drawDamageRecord:function(){var t=this.ctx,s=b.record,e=this.game.damageRecord;for(var i in t.fillStyle="green",e)t.textAlign="right",t.fillText(B[e[i].id].name,s.l,s.t+i*s.sph),t.textAlign="left",t.fillText(e[i].val,s.l+s.spw,s.t+i*s.sph)},drawclasses:function(){var t=this.ctx,s=b.class,e=this.game.classes,i=0;for(var a in e){for(var r in t.fillStyle="#333333",t.textAlign="right",t.fillText(A[a].name,s.l,s.t+s.sph*i),t.textAlign="right",t.fillText(e[a].n,s.l+s.spw,s.t+s.sph*i),t.textAlign="left",A[a].stage)e[a].active&&e[a].active===r?t.fillStyle="#333333":t.fillStyle="#999999",t.fillText(A[a].stage[r],s.l+2*s.spw+25*r,s.t+s.sph*i);i++}},drawEquips:function(){var t=this.ctx,s=this.equips,e=b.equips;for(var i in s)if(t.strokeStyle="#999999",t.strokeRect(e.l,e.t+e.h*i,e.h,e.h),s[i]){var a=new Image;a.src=s[i].src,t.drawImage(a,e.l,e.t+e.h*i,e.h,e.h)}},drawSchedule:function(){var t=this.ctx,s=this.game.schedule,e=b.schedule;if("prepare"===s.status||"battle"===s.status&&s.p>=s.pn){if(t.lineWidth=5,t.beginPath(),s.p<=s.pn)t.strokeStyle="#555",t.arc(this.w/2,e.t,e.arcR,Math.PI/2-(1-s.p/s.pn)*Math.PI*2,Math.PI/2);else{var i=.02*(40-Math.abs((s.p-s.pn)%80-40));t.strokeStyle="rgba(85, 85, 85, ".concat(i,")"),t.arc(this.w/2,e.t,e.arcR,3*-Math.PI/2,Math.PI/2)}t.stroke(),t.lineWidth=1}t.fillText(this.entry.room.stage,this.w/2,e.t)},drawPlayers:function(){var t=this.ctx,s=b.player;for(var e in this.entry.room.users){var i=this.entry.room.users[e];t.fillText(i.name,this.w/2+s.l,s.t+s.sph*e),t.fillText(i.hp,this.w/2+s.l+s.spw,s.t+s.sph*e)}}}},F=G,J=(e("5c0b"),e("2877")),Y=Object(J["a"])(F,a,r,!1,null,null,null),$=Y.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t($)}}).$mount("#app")},"5c0b":function(t,s,e){"use strict";var i=e("e332"),a=e.n(i);a.a},e332:function(t,s,e){}});
//# sourceMappingURL=app.221fbdfb.js.map